<head>
<!-- Generated by perlmod2www.pl -->
<title>
BED documentation.
</title>
<link rel="stylesheet" type="text/css" href="../perl.css">
</head>
<body bgcolor="white">
<span id="modRootPath">APPRIS::Export</span>
<span id="modName">BED</span>
<div id="sep"></div>
<a name="TOP" id="TOP"></a>
<table id="daArea" width="100%"><tr><td id="daEntry" ><a href="#SUMMARY">Summary</a></td><td id="daEntry" ><a href="#vardefs">Package variables</a></td><td id="daEntry" ><a href="#SYNOPSIS">Synopsis</a></td><td id="daEntry" ><a href="#DESCRIPTION">Description</a></td><td id="daEntry" ><a href="#General">General documentation</a></td><td id="daEntry" ><a href="#Methods">Methods</a></td></tr></table>
<div id="sep"></div>
<div id="descTitle">Summary</div>
<div id="descArea"><B>APPRIS::Export::BED</B> - Utility functions for error handling</div>
<div id="sep"></div>
<a name="vardefs" id="vardefs"></a><div id="descTitle">Package variables</div>
<div id="descArea"><div id="libEntry">No package variables defined.</div>
</div>
<div id="sep"></div>
<div id="descTitle">Included modules</div>
<div id="descArea"><div id="libEntry"><span id="use"><a href="../Utils/Constant.html">APPRIS::Utils::Constant</a></span> qw ( $OK_LABEL $NO_LABEL $UNKNOWN_LABEL ) </div>
<div id="libEntry"><span id="use"><a href="../Utils/Exception.html">APPRIS::Utils::Exception</a></span> qw ( throw warning deprecate ) </div>
<div id="libEntry"><span id="use">Data::Dumper</span> </div>
</div>
<div id="sep"></div>
<a name="SYNOPSIS" id="SYNOPSIS"></a>
<div id="descTitle">Synopsis</div>
<div id="descArea"><pre id="podParagraph">  use <B>APPRIS::Export::BED</B> qw(get_annotations);
  
  or to get all methods just

  use APPRIS::Export::BED;

  eval { get_annotations("text to file",file_path) };
  if ($@) {
    print "Caught exception:\n$@";
  }</pre>
</div>
<div id="sep"></div>
<a name="DESCRIPTION" id="DESCRIPTION"></a>
<div id="descTitle">Description</div>
<div id="descArea">The functions exported by this package provide a set of useful methods <br />to export database values as BED format.
</div>
<div id="sep"></div>
<a name="Methods" id="Methods"></a>
<div id="descTitle">Methods</div>
<table id="methIndArea" width="100%" cellspacing="0"><tr><td id="methIndEntry">_aux_get_inertia_annotations</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE1">Code</a></td></tr>
<tr><td id="methIndEntry">_aux_get_spade_annotations</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE2">Code</a></td></tr>
<tr><td id="methIndEntry">_aux_get_thump_annotations</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE3">Code</a></td></tr>
<tr><td id="methIndEntry">get_annotations</td><td id="methIndEntry"><a href="#POD1">Description</a></td><td id="methIndEntry"><a href="#CODE4">Code</a></td></tr>
<tr><td id="methIndEntry">get_appris_annotations</td><td id="methIndEntry"><a href="#POD2">Description</a></td><td id="methIndEntry"><a href="#CODE5">Code</a></td></tr>
<tr><td id="methIndEntry">get_block_from_exon</td><td id="methIndEntry"><a href="#POD3">Description</a></td><td id="methIndEntry"><a href="#CODE6">Code</a></td></tr>
<tr><td id="methIndEntry">get_cexonic_annotations</td><td id="methIndEntry"><a href="#POD4">Description</a></td><td id="methIndEntry"><a href="#CODE7">Code</a></td></tr>
<tr><td id="methIndEntry">get_corsair_annotations</td><td id="methIndEntry"><a href="#POD5">Description</a></td><td id="methIndEntry"><a href="#CODE8">Code</a></td></tr>
<tr><td id="methIndEntry">get_crash_annotations</td><td id="methIndEntry"><a href="#POD6">Description</a></td><td id="methIndEntry"><a href="#CODE9">Code</a></td></tr>
<tr><td id="methIndEntry">get_firestar_annotations</td><td id="methIndEntry"><a href="#POD7">Description</a></td><td id="methIndEntry"><a href="#CODE10">Code</a></td></tr>
<tr><td id="methIndEntry">get_inertia_annotations</td><td id="methIndEntry"><a href="#POD8">Description</a></td><td id="methIndEntry"><a href="#CODE11">Code</a></td></tr>
<tr><td id="methIndEntry">get_matador3d_annotations</td><td id="methIndEntry"><a href="#POD9">Description</a></td><td id="methIndEntry"><a href="#CODE12">Code</a></td></tr>
<tr><td id="methIndEntry">get_spade_annotations</td><td id="methIndEntry"><a href="#POD10">Description</a></td><td id="methIndEntry"><a href="#CODE13">Code</a></td></tr>
<tr><td id="methIndEntry">get_thump_annotations</td><td id="methIndEntry"><a href="#POD11">Description</a></td><td id="methIndEntry"><a href="#CODE14">Code</a></td></tr>
<tr><td id="methIndEntry">get_trans_annotations</td><td id="methIndEntry"><a href="#POD12">Description</a></td><td id="methIndEntry"><a href="#CODE15">Code</a></td></tr>
<tr><td id="methIndEntry">print_annotations</td><td id="methIndEntry"><a href="#POD13">Description</a></td><td id="methIndEntry"><a href="#CODE16">Code</a></td></tr>
<tr><td id="methIndEntry">print_data</td><td id="methIndEntry"><a href="#POD14">Description</a></td><td id="methIndEntry"><a href="#CODE17">Code</a></td></tr>
</table>
<div id="sep"></div>
<a name="MethDesc" id="MethDesc"></a>
<div id="mainTitle">Methods description</div>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_get_annotations" id="_pod_get_annotations"></a><a name="POD1" id="POD1"></a>get_annotations</td><td ><a href="#CODE4">code</a></td><td >&nbsp;&nbsp;&nbsp;&nbsp;</td><td ><a href="#POD2">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph">  Arg [1]    : Listref of APPRIS::Gene or undef
  Arg [2]    : String - $position
               genome position (chr22:20116979-20137016)
  Arg [3]    : String - $source
               List of sources ('all', ... )
  Arg [4]    : String - $head
               flag of head title ('yes','no','only')
  Arg [5]    : String - $version
  Arg [6]    : String - $date
  Example    : get_annotations($feature,'chr22:20116979-20137016','no','appris');  
  Description: Retrieves text as BED format with the annotations.
  Returntype : String or undef
  Exceptions : if we cant get the gene or transcript in given coord system
  Caller     : general
  Status     : Stable</pre></td></tr></table>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_get_appris_annotations" id="_pod_get_appris_annotations"></a><a name="POD2" id="POD2"></a>get_appris_annotations</td><td ><a href="#CODE5">code</a></td><td ><a href="#POD1">prev</a></td><td ><a href="#POD3">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph">  Arg [1]    : String - the stable identifier of transcript
  Arg [4]    : APPRIS::Transcript
  Arg [5]    : Object - internal BED variable 
  Example    : $annot = get_appris_annotations($trans_id, $feat, $ref_out);  
  Description: Retrieves specific annotation.
  Returntype : String or undef</pre></td></tr></table>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_get_block_from_exon" id="_pod_get_block_from_exon"></a><a name="POD3" id="POD3"></a>get_block_from_exon</td><td ><a href="#CODE6">code</a></td><td ><a href="#POD2">prev</a></td><td ><a href="#POD4">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph">  Arg [1]    : Int - start position
  Arg [2]    : Int - end position
  Arg [3]    : Int - start position of exon
  Arg [4]    : Int - end position of exon
  Example    : get_block_from_exon($e_start, $e_end, $b_start, $b_end);
  Description: Get the BED block from exon.
  Returntype : (Int- init, Int- size) or (undef,undef)
  Exceptions : none</pre></td></tr></table>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_get_cexonic_annotations" id="_pod_get_cexonic_annotations"></a><a name="POD4" id="POD4"></a>get_cexonic_annotations</td><td ><a href="#CODE7">code</a></td><td ><a href="#POD3">prev</a></td><td ><a href="#POD5">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph">  Arg [1]    : String - the stable identifier of transcript
  Arg [4]    : APPRIS::Transcript
  Arg [5]    : Object - internal BED variable 
  Example    : $annot = get_cexonic_annotations($trans_id, $feat, $ref_out);  
  Description: Retrieves specific annotation.
  Returntype : String or undef</pre></td></tr></table>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_get_corsair_annotations" id="_pod_get_corsair_annotations"></a><a name="POD5" id="POD5"></a>get_corsair_annotations</td><td ><a href="#CODE8">code</a></td><td ><a href="#POD4">prev</a></td><td ><a href="#POD6">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph">  Arg [1]    : String - the stable identifier of transcript
  Arg [4]    : APPRIS::Transcript
  Arg [5]    : Object - internal BED variable 
  Example    : $annot = get_corsair_annotations($trans_id, $feat, $ref_out);  
  Description: Retrieves specific annotation.
  Returntype : String or undef</pre></td></tr></table>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_get_crash_annotations" id="_pod_get_crash_annotations"></a><a name="POD6" id="POD6"></a>get_crash_annotations</td><td ><a href="#CODE9">code</a></td><td ><a href="#POD5">prev</a></td><td ><a href="#POD7">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph">  Arg [1]    : String - the stable identifier of transcript
  Arg [4]    : APPRIS::Transcript
  Arg [5]    : Object - internal BED variable 
  Example    : $annot = get_crash_annotations($trans_id, $feat, $ref_out);  
  Description: Retrieves specific annotation.
  Returntype : String or undef</pre></td></tr></table>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_get_firestar_annotations" id="_pod_get_firestar_annotations"></a><a name="POD7" id="POD7"></a>get_firestar_annotations</td><td ><a href="#CODE10">code</a></td><td ><a href="#POD6">prev</a></td><td ><a href="#POD8">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph">  Arg [1]    : String - the stable identifier of transcript
  Arg [4]    : APPRIS::Transcript
  Arg [5]    : Object - internal BED variable 
  Example    : $annot = get_firestar_annotations($trans_id, $feat, $ref_out);  
  Description: Retrieves specific annotation.
  Returntype : String or undef</pre></td></tr></table>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_get_inertia_annotations" id="_pod_get_inertia_annotations"></a><a name="POD8" id="POD8"></a>get_inertia_annotations</td><td ><a href="#CODE11">code</a></td><td ><a href="#POD7">prev</a></td><td ><a href="#POD9">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph">  Arg [1]    : String - the stable identifier of transcript
  Arg [4]    : APPRIS::Transcript
  Arg [5]    : Object - internal BED variable 
  Example    : $annot = get_inertia_annotations($trans_id, $feat, $ref_out);  
  Description: Retrieves specific annotation.
  Returntype : String or undef</pre></td></tr></table>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_get_matador3d_annotations" id="_pod_get_matador3d_annotations"></a><a name="POD9" id="POD9"></a>get_matador3d_annotations</td><td ><a href="#CODE12">code</a></td><td ><a href="#POD8">prev</a></td><td ><a href="#POD10">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph">  Arg [1]    : String - the stable identifier of transcript
  Arg [4]    : APPRIS::Transcript
  Arg [5]    : Object - internal BED variable 
  Example    : $annot = get_matador3d_annotations($trans_id, $feat, $ref_out);  
  Description: Retrieves specific annotation.
  Returntype : String or undef</pre></td></tr></table>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_get_spade_annotations" id="_pod_get_spade_annotations"></a><a name="POD10" id="POD10"></a>get_spade_annotations</td><td ><a href="#CODE13">code</a></td><td ><a href="#POD9">prev</a></td><td ><a href="#POD11">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph">  Arg [1]    : String - the stable identifier of transcript
  Arg [4]    : APPRIS::Transcript
  Arg [5]    : Object - internal BED variable 
  Example    : $annot = get_spade_annotations($trans_id, $feat, $ref_out);  
  Description: Retrieves specific annotation.
  Returntype : String or undef</pre></td></tr></table>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_get_thump_annotations" id="_pod_get_thump_annotations"></a><a name="POD11" id="POD11"></a>get_thump_annotations</td><td ><a href="#CODE14">code</a></td><td ><a href="#POD10">prev</a></td><td ><a href="#POD12">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph">  Arg [1]    : String - the stable identifier of transcript
  Arg [4]    : APPRIS::Transcript
  Arg [5]    : Object - internal BED variable 
  Example    : $annot = get_thump_annotations($trans_id, $feat, $ref_out);  
  Description: Retrieves specific annotation.
  Returntype : String or undef</pre></td></tr></table>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_get_trans_annotations" id="_pod_get_trans_annotations"></a><a name="POD12" id="POD12"></a>get_trans_annotations</td><td ><a href="#CODE15">code</a></td><td ><a href="#POD11">prev</a></td><td ><a href="#POD13">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph">  Arg [1]    : APPRIS::Transcript or undef
  Arg [2]    : String - $position
               genome position (chr22:20116979-20137016)
  Arg [3]    : String - $source
               List of sources ('all', ... )
  Example    : get_annotations($feature,'chr22:20116979-20137016','appris');  
  Description: Retrieves bed information of transcript.
  Returntype : Nothing (reference output)</pre></td></tr></table>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_print_annotations" id="_pod_print_annotations"></a><a name="POD13" id="POD13"></a>print_annotations</td><td ><a href="#CODE16">code</a></td><td ><a href="#POD12">prev</a></td><td ><a href="#POD14">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph">  Arg [1]    : Hash - internal hash of bed annotations
  Example    : $annot = print_annotations($report);
  Description: Print the bed annotations.
  Returntype : String or ''</pre></td></tr></table>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_print_data" id="_pod_print_data"></a><a name="POD14" id="POD14"></a>print_data</td><td ><a href="#CODE17">code</a></td><td ><a href="#POD13">prev</a></td><td ><a href="#POD15">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph">  Arg [1]    : Hast - data attributes of bed
               $data = {
                   'chr'          => ''
                   'start'        => ''
                   'end'          => ''
                   'name'         => ''
                   'score'        => ''
                   'strand'       => ''
                   'thick_start'  => ''
                   'thick_end'    => ''
                   'color'        => ''
                   'blocks'       => ''
                   'block_sizes'  => ''
                   'block_starts' => ''
               };
  Example    : $annot = print_data($data);
  Description: Print the bed annotations.
               Chromosome Start End Name Score Strand 
                 ThickStart ThickEnd Color Blocks BlockSizes BlockStarts
                 
                 The start values are -1 due to UCSC Genome browser prints bad
  Returntype : String or ''</pre></td></tr></table>
<div id="sep"></div>
<a name="MethCode" id="MethCode"></a>
<div id="mainTitle">Methods code</div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE1" id="CODE1"></a>_aux_get_inertia_annotations</td><td >description</td><td >prev</td><td ><a href="#CODE2">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="privSubName">_aux_get_inertia_annotations</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$type</span>, <span id="var">$transcript_id</span>, <span id="var">$feature</span>, <span id="var">$res_list</span>, <span id="var">$ref_output</span><span id="braces">)</span> = <span id="var">@_</span>;

<span id="comment">#print DATA_7 &quot;RES_LIST: $transcript_id:\n&quot;.Dumper($res_list).&quot;\n&quot;;</span><br />	<span id="perlKey">if</span> <span id="braces">(</span> <span id="braces">(</span><span id="perlFunc">ref</span><span id="braces">(</span><span id="var">$res_list</span><span id="braces">)</span> <span id="perlKey">eq</span> <span id="sqStr">'ARRAY'</span><span id="braces">)</span> and <span id="braces">(</span><span id="perlFunc">scalar</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$res_list</span><span id="braces">}</span><span id="braces">)</span> &gt; 0<span id="braces">)</span> <span id="braces">)</span> <span id="braces">{</span>
		<span id="comment"># get initial data</span><br />		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$num_res</span><span id="braces">)</span> = <span id="perlFunc">scalar</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$res_list</span><span id="braces">}</span><span id="braces">)</span>;		
		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$trans_chr</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">chromosome</span>;
		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$trans_start</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">start</span>;
		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$trans_end</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">end</span>;
		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$trans_strand</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">strand</span>;
		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$score</span><span id="braces">)</span> = 0;
		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$thick_start</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">start</span>;
		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$thick_end</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">end</span>;
		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$color</span><span id="braces">)</span> = 0;
		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$blocks</span><span id="braces">)</span> = 0;
		<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$trans_strand</span> <span id="perlKey">eq</span> <span id="sqStr">'-'</span> <span id="braces">)</span> <span id="braces">{</span>
			<span id="var">$trans_start</span> = <span id="var">$res_list</span>-&gt;<span id="braces">[</span><span id="var">$num_res</span>-1<span id="braces">]</span>-&gt;<span id="method">start</span>;
			<span id="var">$trans_end</span> = <span id="var">$res_list</span>-&gt;<span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="method">end</span>;
			<span id="var">$thick_start</span> = <span id="var">$trans_start</span>;
			<span id="var">$thick_end</span> = <span id="var">$trans_end</span>;
		<span id="braces">}</span>
		<span id="perlKey">else</span> <span id="braces">{</span>
			<span id="var">$trans_start</span> = <span id="var">$res_list</span>-&gt;<span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="method">start</span>; 
			<span id="var">$trans_end</span> = <span id="var">$res_list</span>-&gt;<span id="braces">[</span><span id="var">$num_res</span>-1<span id="braces">]</span>-&gt;<span id="method">end</span>;
			<span id="var">$thick_start</span> = <span id="var">$trans_start</span>;
			<span id="var">$thick_end</span> = <span id="var">$trans_end</span>;
		<span id="braces">}</span>
		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$data</span><span id="braces">)</span> = <span id="braces">{</span>
				<span id="sqStr">'chr'</span>			=&gt; <span id="var">$trans_chr</span>,
				<span id="sqStr">'name'</span>			=&gt; <span id="var">$transcript_id</span>,
				<span id="sqStr">'start'</span>			=&gt; <span id="var">$trans_start</span>,
				<span id="sqStr">'end'</span>			=&gt; <span id="var">$trans_end</span>,
				<span id="sqStr">'strand'</span>		=&gt; <span id="var">$trans_strand</span>,
				<span id="sqStr">'score'</span>			=&gt; <span id="var">$score</span>,
				<span id="sqStr">'thick_start'</span>	=&gt; <span id="var">$thick_start</span>,
				<span id="sqStr">'thick_end'</span>		=&gt; <span id="var">$thick_end</span>,			
				<span id="sqStr">'color'</span>			=&gt; <span id="var">$color</span>,
				<span id="sqStr">'blocks'</span>		=&gt; <span id="var">$blocks</span>
		<span id="braces">}</span>;
					
		<span id="comment"># get block annotations</span><br />		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$res</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$res_list</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$pos_start</span><span id="braces">)</span> = <span id="var">$res</span>-&gt;<span id="method">start</span>;
			<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$pos_end</span><span id="braces">)</span> = <span id="var">$res</span>-&gt;<span id="method">end</span>;
			<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$pos_strand</span><span id="braces">)</span> = <span id="var">$res</span>-&gt;<span id="method">strand</span>;
			<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$trans_strand</span> <span id="perlKey">eq</span> <span id="sqStr">'-'</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="var">$pos_start</span> = <span id="var">$res</span>-&gt;<span id="method">end</span>;
				<span id="var">$pos_end</span> = <span id="var">$res</span>-&gt;<span id="method">start</span>;
			<span id="braces">}</span>
			<span id="perlKey">else</span> <span id="braces">{</span>
				<span id="var">$pos_start</span> = <span id="var">$res</span>-&gt;<span id="method">start</span>;
				<span id="var">$pos_end</span> = <span id="var">$res</span>-&gt;<span id="method">end</span>;
			<span id="braces">}</span>
			<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$init</span>, <span id="var">$length</span><span id="braces">)</span> = <span id="method">get_block_from_exon</span><span id="braces">(</span><span id="var">$pos_start</span>, <span id="var">$pos_end</span>, <span id="var">$pos_strand</span>, <span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'thick_start'</span><span id="braces">}</span>, <span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'thick_end'</span><span id="braces">}</span><span id="braces">)</span>;
			<span id="perlFunc">push</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'block_starts'</span><span id="braces">}</span><span id="braces">}</span>, <span id="var">$init</span><span id="braces">)</span>;
			<span id="perlFunc">push</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'block_sizes'</span><span id="braces">}</span><span id="braces">}</span>, <span id="var">$length</span><span id="braces">)</span>;
			<span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'blocks'</span><span id="braces">}</span>++;	

		<span id="braces">}</span>
		<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$type</span> <span id="perlKey">eq</span> <span id="sqStr">'neutral_evolution'</span> <span id="braces">)</span> <span id="braces">{</span>
			$<span id="braces">{</span><span id="var">$ref_output</span><span id="braces">}</span>-&gt;<span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span><span id="sqStr">'body'</span><span id="braces">}</span> .= <span id="method">print_data</span><span id="braces">(</span><span id="var">$data</span><span id="braces">)</span>;								
		<span id="braces">}</span>
		<span id="perlKey">elsif</span> <span id="braces">(</span> <span id="var">$type</span> <span id="perlKey">eq</span> <span id="sqStr">'unusual_evolution'</span> <span id="braces">)</span> <span id="braces">{</span>
			$<span id="braces">{</span><span id="var">$ref_output</span><span id="braces">}</span>-&gt;<span id="braces">[</span>1<span id="braces">]</span>-&gt;<span id="braces">{</span><span id="sqStr">'body'</span><span id="braces">}</span> .= <span id="method">print_data</span><span id="braces">(</span><span id="var">$data</span><span id="braces">)</span>;								
		<span id="braces">}</span>		
	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE2" id="CODE2"></a>_aux_get_spade_annotations</td><td >description</td><td ><a href="#CODE1">prev</a></td><td ><a href="#CODE3">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="privSubName">_aux_get_spade_annotations</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$type</span>, <span id="var">$transcript_id</span>, <span id="var">$feature</span>, <span id="var">$res_list</span>, <span id="var">$ref_output</span><span id="braces">)</span> = <span id="var">@_</span>;

<span id="comment">#print DATA_7 &quot;RES_LIST: $transcript_id:\n&quot;.Dumper($res_list).&quot;\n&quot;;</span><br />	<span id="perlKey">if</span> <span id="braces">(</span> <span id="braces">(</span><span id="perlFunc">ref</span><span id="braces">(</span><span id="var">$res_list</span><span id="braces">)</span> <span id="perlKey">eq</span> <span id="sqStr">'ARRAY'</span><span id="braces">)</span> and <span id="braces">(</span><span id="perlFunc">scalar</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$res_list</span><span id="braces">}</span><span id="braces">)</span> &gt; 0<span id="braces">)</span> <span id="braces">)</span> <span id="braces">{</span>
		<span id="comment"># get initial data</span><br />		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$num_res</span><span id="braces">)</span> = <span id="perlFunc">scalar</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$res_list</span><span id="braces">}</span><span id="braces">)</span>;		
		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$trans_chr</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">chromosome</span>;
		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$trans_start</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">start</span>;
		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$trans_end</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">end</span>;
		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$trans_strand</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">strand</span>;
		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$score</span><span id="braces">)</span> = 0;
		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$thick_start</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">start</span>;
		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$thick_end</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">end</span>;
		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$color</span><span id="braces">)</span> = 0;
		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$blocks</span><span id="braces">)</span> = 0;
		<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$trans_strand</span> <span id="perlKey">eq</span> <span id="sqStr">'-'</span> <span id="braces">)</span> <span id="braces">{</span>
			<span id="var">$trans_start</span> = <span id="var">$res_list</span>-&gt;<span id="braces">[</span><span id="var">$num_res</span>-1<span id="braces">]</span>-&gt;<span id="method">start</span>;
			<span id="var">$trans_end</span> = <span id="var">$res_list</span>-&gt;<span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="method">end</span>;
			<span id="var">$thick_start</span> = <span id="var">$trans_start</span>;
			<span id="var">$thick_end</span> = <span id="var">$trans_end</span>;
		<span id="braces">}</span>
		<span id="perlKey">else</span> <span id="braces">{</span>
			<span id="var">$trans_start</span> = <span id="var">$res_list</span>-&gt;<span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="method">start</span>; 
			<span id="var">$trans_end</span> = <span id="var">$res_list</span>-&gt;<span id="braces">[</span><span id="var">$num_res</span>-1<span id="braces">]</span>-&gt;<span id="method">end</span>;
			<span id="var">$thick_start</span> = <span id="var">$trans_start</span>;
			<span id="var">$thick_end</span> = <span id="var">$trans_end</span>;
		<span id="braces">}</span>
		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$data</span><span id="braces">)</span> = <span id="braces">{</span>
				<span id="sqStr">'chr'</span>			=&gt; <span id="var">$trans_chr</span>,
				<span id="sqStr">'name'</span>			=&gt; <span id="var">$transcript_id</span>,
				<span id="sqStr">'start'</span>			=&gt; <span id="var">$trans_start</span>,
				<span id="sqStr">'end'</span>			=&gt; <span id="var">$trans_end</span>,
				<span id="sqStr">'strand'</span>		=&gt; <span id="var">$trans_strand</span>,
				<span id="sqStr">'score'</span>			=&gt; <span id="var">$score</span>,
				<span id="sqStr">'thick_start'</span>	=&gt; <span id="var">$thick_start</span>,
				<span id="sqStr">'thick_end'</span>		=&gt; <span id="var">$thick_end</span>,			
				<span id="sqStr">'color'</span>			=&gt; <span id="var">$color</span>,
				<span id="sqStr">'blocks'</span>		=&gt; <span id="var">$blocks</span>
		<span id="braces">}</span>;
		<span id="comment"># get block annotations</span><br />		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$res</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$res_list</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$pos_start</span><span id="braces">)</span> = <span id="var">$res</span>-&gt;<span id="method">start</span>;
			<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$pos_end</span><span id="braces">)</span> = <span id="var">$res</span>-&gt;<span id="method">end</span>;
			<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$pos_strand</span><span id="braces">)</span> = <span id="var">$res</span>-&gt;<span id="method">strand</span>;
			<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$trans_strand</span> <span id="perlKey">eq</span> <span id="sqStr">'-'</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="var">$pos_start</span> = <span id="var">$res</span>-&gt;<span id="method">end</span>;
				<span id="var">$pos_end</span> = <span id="var">$res</span>-&gt;<span id="method">start</span>;
			<span id="braces">}</span>
			<span id="perlKey">else</span> <span id="braces">{</span>
				<span id="var">$pos_start</span> = <span id="var">$res</span>-&gt;<span id="method">start</span>;
				<span id="var">$pos_end</span> = <span id="var">$res</span>-&gt;<span id="method">end</span>;
			<span id="braces">}</span>
			<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$init</span>, <span id="var">$length</span><span id="braces">)</span> = <span id="method">get_block_from_exon</span><span id="braces">(</span><span id="var">$pos_start</span>, <span id="var">$pos_end</span>, <span id="var">$pos_strand</span>, <span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'thick_start'</span><span id="braces">}</span>, <span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'thick_end'</span><span id="braces">}</span><span id="braces">)</span>;
			<span id="perlFunc">push</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'block_starts'</span><span id="braces">}</span><span id="braces">}</span>, <span id="var">$init</span><span id="braces">)</span>;
			<span id="perlFunc">push</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'block_sizes'</span><span id="braces">}</span><span id="braces">}</span>, <span id="var">$length</span><span id="braces">)</span>;
			<span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'blocks'</span><span id="braces">}</span>++;	

		<span id="braces">}</span>
		<span id="comment"># get block annotations</span><br /><span id="comment">#		foreach my $res (@{$res_list}) {</span><br /><span id="comment">#</span><br /><span id="comment">#print DATA_7 &quot;DATA_7: $transcript_id:\n&quot;.Dumper($data).&quot;\n&quot;;</span><br /><span id="comment">#			</span><br /><span id="comment">#			if ( $feature-&gt;translate and $feature-&gt;translate-&gt;cds ) {</span><br /><span id="comment">#				my ($translation) = $feature-&gt;translate;</span><br /><span id="comment">#				my ($cds_list) = $translation-&gt;cds;</span><br /><span id="comment">#				my ($num_cds) = scalar(@{$cds_list});</span><br /><span id="comment">#				my ($contained_cds) = $translation-&gt;get_overlapping_cds($res-&gt;start, $res-&gt;end);</span><br /><span id="comment">#				my (@sorted_contained_cds) = @{$contained_cds};</span><br /><span id="comment">#				for (my $i = 0; $i &lt; scalar(@sorted_contained_cds); $i++) {</span><br /><span id="comment">#print DATA_7 &quot;\nRES:\n&quot;.Dumper($res).&quot;\n&quot;;</span><br /><span id="comment">#print DATA_7 &quot;\nCDS:\n&quot;.Dumper($sorted_contained_cds[$i]).&quot;\n&quot;;</span><br /><span id="comment">#					if ( scalar(@sorted_contained_cds) == 1 ) { # Within one CDS</span><br /><span id="comment">#						my ($pos_start) = $res-&gt;alignment_start;</span><br /><span id="comment">#						my ($pos_end) = $res-&gt;alignment_end;</span><br /><span id="comment">#						my ($pos_strand) = $res-&gt;strand;</span><br /><span id="comment">#print DATA_7 &quot;\nPOSITION: start: $pos_start end: $pos_end strand: $pos_strand\n&quot;;</span><br /><span id="comment">#						my ($init, $length) = get_block_from_exon($pos_start, $pos_end, $pos_strand, $data-&gt;{'thick_start'}, $data-&gt;{'thick_end'});</span><br /><span id="comment">#print DATA_7 &quot;\nINIT: ($init, $length)\n&quot;;</span><br /><span id="comment">#	</span><br /><span id="comment">#						push(@{$data-&gt;{'block_starts'}}, $init);</span><br /><span id="comment">#						push(@{$data-&gt;{'block_sizes'}}, $length);</span><br /><span id="comment">#						$data-&gt;{'blocks'}++;	</span><br /><span id="comment">#					}</span><br /><span id="comment">#					else { # Within several CDS</span><br /><span id="comment">#						my ($cds_out) = $sorted_contained_cds[$i];</span><br /><span id="comment">#						my ($pos_start) = $cds_out-&gt;start;</span><br /><span id="comment">#						my ($pos_end) = $cds_out-&gt;end;</span><br /><span id="comment">#						my ($pos_strand) = $cds_out-&gt;strand;				</span><br /><span id="comment">#						if ( $i==0 ) {</span><br /><span id="comment">#print DATA_7 &quot;\nENTRA_1\n&quot;;					</span><br /><span id="comment">#							if ($trans_strand eq '-') {</span><br /><span id="comment">#								$pos_start = $res-&gt;end;</span><br /><span id="comment">#								$pos_end = $cds_out-&gt;start;</span><br /><span id="comment">#							}</span><br /><span id="comment">#							else {</span><br /><span id="comment">#								$pos_start = $res-&gt;start;</span><br /><span id="comment">#								$pos_end = $cds_out-&gt;end;</span><br /><span id="comment">#							}</span><br /><span id="comment">#						}</span><br /><span id="comment">#						elsif ( $i == scalar(@sorted_contained_cds)-1 ) {</span><br /><span id="comment">#print DATA_7 &quot;\nENTRA_2\n&quot;;</span><br /><span id="comment">#							if ( $trans_strand eq '-' ) {</span><br /><span id="comment">#								$pos_start = $cds_out-&gt;end;</span><br /><span id="comment">#								$pos_end = $res-&gt;start;</span><br /><span id="comment">#							}</span><br /><span id="comment">#							else {</span><br /><span id="comment">#								$pos_start = $cds_out-&gt;start;</span><br /><span id="comment">#								$pos_end = $res-&gt;end;</span><br /><span id="comment">#							}</span><br /><span id="comment">#						}</span><br /><span id="comment">#print DATA_7 &quot;\nPOSITION_2: start: $pos_start end: $pos_end strand: $pos_strand\n&quot;;</span><br /><span id="comment">#print DATA_7 &quot;TRACK_7_2: $transcript_id:\n&quot;.Dumper($data).&quot;\n&quot;;					</span><br /><span id="comment">#						my ($init, $length) = get_block_from_exon($pos_start, $pos_end, $pos_strand, $data-&gt;{'thick_start'}, $data-&gt;{'thick_end'});</span><br /><span id="comment">#print DATA_7 &quot;\nINIT_2: ($init, $length)\n&quot;;</span><br /><span id="comment">#						push(@{$data-&gt;{'block_starts'}}, $init);</span><br /><span id="comment">#						push(@{$data-&gt;{'block_sizes'}}, $length);</span><br /><span id="comment">#						$data-&gt;{'blocks'}++;	</span><br /><span id="comment">#					}</span><br /><span id="comment">#				}</span><br /><span id="comment">#			}		</span><br /><span id="comment">#		}</span><br />		<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$type</span> <span id="perlKey">eq</span> <span id="sqStr">'domain'</span> <span id="braces">)</span> <span id="braces">{</span>
			$<span id="braces">{</span><span id="var">$ref_output</span><span id="braces">}</span>-&gt;<span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span><span id="sqStr">'body'</span><span id="braces">}</span> .= <span id="method">print_data</span><span id="braces">(</span><span id="var">$data</span><span id="braces">)</span>;								
		<span id="braces">}</span>
		<span id="perlKey">elsif</span> <span id="braces">(</span> <span id="var">$type</span> <span id="perlKey">eq</span> <span id="sqStr">'domain_possibly_damaged'</span> <span id="braces">)</span> <span id="braces">{</span>
			$<span id="braces">{</span><span id="var">$ref_output</span><span id="braces">}</span>-&gt;<span id="braces">[</span>1<span id="braces">]</span>-&gt;<span id="braces">{</span><span id="sqStr">'body'</span><span id="braces">}</span> .= <span id="method">print_data</span><span id="braces">(</span><span id="var">$data</span><span id="braces">)</span>;								
		<span id="braces">}</span>
		<span id="perlKey">elsif</span> <span id="braces">(</span> <span id="var">$type</span> <span id="perlKey">eq</span> <span id="sqStr">'domain_damaged'</span> <span id="braces">)</span> <span id="braces">{</span>
			$<span id="braces">{</span><span id="var">$ref_output</span><span id="braces">}</span>-&gt;<span id="braces">[</span>2<span id="braces">]</span>-&gt;<span id="braces">{</span><span id="sqStr">'body'</span><span id="braces">}</span> .= <span id="method">print_data</span><span id="braces">(</span><span id="var">$data</span><span id="braces">)</span>;								
		<span id="braces">}</span>
		<span id="perlKey">elsif</span> <span id="braces">(</span> <span id="var">$type</span> <span id="perlKey">eq</span> <span id="sqStr">'domain_wrong'</span> <span id="braces">)</span> <span id="braces">{</span>
			$<span id="braces">{</span><span id="var">$ref_output</span><span id="braces">}</span>-&gt;<span id="braces">[</span>3<span id="braces">]</span>-&gt;<span id="braces">{</span><span id="sqStr">'body'</span><span id="braces">}</span> .= <span id="method">print_data</span><span id="braces">(</span><span id="var">$data</span><span id="braces">)</span>;								
		<span id="braces">}</span>			
	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE3" id="CODE3"></a>_aux_get_thump_annotations</td><td >description</td><td ><a href="#CODE2">prev</a></td><td ><a href="#CODE4">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="privSubName">_aux_get_thump_annotations</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$type</span>, <span id="var">$transcript_id</span>, <span id="var">$feature</span>, <span id="var">$res_list</span>, <span id="var">$ref_output</span><span id="braces">)</span> = <span id="var">@_</span>;

<span id="comment">#print DATA_7 &quot;RES_LIST: $transcript_id:\n&quot;.Dumper($res_list).&quot;\n&quot;;</span><br />	<span id="perlKey">if</span> <span id="braces">(</span> <span id="braces">(</span><span id="perlFunc">ref</span><span id="braces">(</span><span id="var">$res_list</span><span id="braces">)</span> <span id="perlKey">eq</span> <span id="sqStr">'ARRAY'</span><span id="braces">)</span> and <span id="braces">(</span><span id="perlFunc">scalar</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$res_list</span><span id="braces">}</span><span id="braces">)</span> &gt; 0<span id="braces">)</span> <span id="braces">)</span> <span id="braces">{</span>
		<span id="comment"># get initial data</span><br />		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$num_res</span><span id="braces">)</span> = <span id="perlFunc">scalar</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$res_list</span><span id="braces">}</span><span id="braces">)</span>;		
		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$trans_chr</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">chromosome</span>;
		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$trans_start</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">start</span>;
		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$trans_end</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">end</span>;
		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$trans_strand</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">strand</span>;
		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$score</span><span id="braces">)</span> = 0;
		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$thick_start</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">start</span>;
		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$thick_end</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">end</span>;
		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$color</span><span id="braces">)</span> = 0;
		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$blocks</span><span id="braces">)</span> = 0;
		<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$trans_strand</span> <span id="perlKey">eq</span> <span id="sqStr">'-'</span> <span id="braces">)</span> <span id="braces">{</span>
			<span id="var">$trans_start</span> = <span id="var">$res_list</span>-&gt;<span id="braces">[</span><span id="var">$num_res</span>-1<span id="braces">]</span>-&gt;<span id="method">start</span>;
			<span id="var">$trans_end</span> = <span id="var">$res_list</span>-&gt;<span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="method">end</span>;
			<span id="var">$thick_start</span> = <span id="var">$trans_start</span>;
			<span id="var">$thick_end</span> = <span id="var">$trans_end</span>;
		<span id="braces">}</span>
		<span id="perlKey">else</span> <span id="braces">{</span>
			<span id="var">$trans_start</span> = <span id="var">$res_list</span>-&gt;<span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="method">start</span>; 
			<span id="var">$trans_end</span> = <span id="var">$res_list</span>-&gt;<span id="braces">[</span><span id="var">$num_res</span>-1<span id="braces">]</span>-&gt;<span id="method">end</span>;
			<span id="var">$thick_start</span> = <span id="var">$trans_start</span>;
			<span id="var">$thick_end</span> = <span id="var">$trans_end</span>;
		<span id="braces">}</span>
		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$data</span><span id="braces">)</span> = <span id="braces">{</span>
				<span id="sqStr">'chr'</span>			=&gt; <span id="var">$trans_chr</span>,
				<span id="sqStr">'name'</span>			=&gt; <span id="var">$transcript_id</span>,
				<span id="sqStr">'start'</span>			=&gt; <span id="var">$trans_start</span>,
				<span id="sqStr">'end'</span>			=&gt; <span id="var">$trans_end</span>,
				<span id="sqStr">'strand'</span>		=&gt; <span id="var">$trans_strand</span>,
				<span id="sqStr">'score'</span>			=&gt; <span id="var">$score</span>,
				<span id="sqStr">'thick_start'</span>	=&gt; <span id="var">$thick_start</span>,
				<span id="sqStr">'thick_end'</span>		=&gt; <span id="var">$thick_end</span>,			
				<span id="sqStr">'color'</span>			=&gt; <span id="var">$color</span>,
				<span id="sqStr">'blocks'</span>		=&gt; <span id="var">$blocks</span>
		<span id="braces">}</span>;
		<span id="comment"># get block annotations</span><br />		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$res</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$res_list</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$pos_start</span><span id="braces">)</span> = <span id="var">$res</span>-&gt;<span id="method">start</span>;
			<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$pos_end</span><span id="braces">)</span> = <span id="var">$res</span>-&gt;<span id="method">end</span>;
			<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$pos_strand</span><span id="braces">)</span> = <span id="var">$res</span>-&gt;<span id="method">strand</span>;
			<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$trans_strand</span> <span id="perlKey">eq</span> <span id="sqStr">'-'</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="var">$pos_start</span> = <span id="var">$res</span>-&gt;<span id="method">end</span>;
				<span id="var">$pos_end</span> = <span id="var">$res</span>-&gt;<span id="method">start</span>;
			<span id="braces">}</span>
			<span id="perlKey">else</span> <span id="braces">{</span>
				<span id="var">$pos_start</span> = <span id="var">$res</span>-&gt;<span id="method">start</span>;
				<span id="var">$pos_end</span> = <span id="var">$res</span>-&gt;<span id="method">end</span>;
			<span id="braces">}</span>
			<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$init</span>, <span id="var">$length</span><span id="braces">)</span> = <span id="method">get_block_from_exon</span><span id="braces">(</span><span id="var">$pos_start</span>, <span id="var">$pos_end</span>, <span id="var">$pos_strand</span>, <span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'thick_start'</span><span id="braces">}</span>, <span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'thick_end'</span><span id="braces">}</span><span id="braces">)</span>;
			<span id="perlFunc">push</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'block_starts'</span><span id="braces">}</span><span id="braces">}</span>, <span id="var">$init</span><span id="braces">)</span>;
			<span id="perlFunc">push</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'block_sizes'</span><span id="braces">}</span><span id="braces">}</span>, <span id="var">$length</span><span id="braces">)</span>;
			<span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'blocks'</span><span id="braces">}</span>++;	

		<span id="braces">}</span>
		<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$type</span> <span id="perlKey">eq</span> <span id="sqStr">'transmembrane_helixes'</span> <span id="braces">)</span> <span id="braces">{</span>
			$<span id="braces">{</span><span id="var">$ref_output</span><span id="braces">}</span>-&gt;<span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span><span id="sqStr">'body'</span><span id="braces">}</span> .= <span id="method">print_data</span><span id="braces">(</span><span id="var">$data</span><span id="braces">)</span>;								
		<span id="braces">}</span>
		<span id="perlKey">elsif</span> <span id="braces">(</span> <span id="var">$type</span> <span id="perlKey">eq</span> <span id="sqStr">'damaged_transmembrane_helixes'</span> <span id="braces">)</span> <span id="braces">{</span>
			$<span id="braces">{</span><span id="var">$ref_output</span><span id="braces">}</span>-&gt;<span id="braces">[</span>1<span id="braces">]</span>-&gt;<span id="braces">{</span><span id="sqStr">'body'</span><span id="braces">}</span> .= <span id="method">print_data</span><span id="braces">(</span><span id="var">$data</span><span id="braces">)</span>;								
		<span id="braces">}</span>
	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE4" id="CODE4"></a>get_annotations</td><td ><a href="#POD1">description</a></td><td ><a href="#CODE3">prev</a></td><td ><a href="#CODE5">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_annotations</span>
{<pre>    <span id="perlKey">my</span> <span id="braces">(</span><span id="var">$feature</span>, <span id="var">$position</span>, <span id="var">$source</span>, <span id="var">$head</span>, <span id="var">$version</span>, <span id="var">$date</span><span id="braces">)</span> = <span id="var">@_</span>;
    <span id="perlKey">my</span> <span id="braces">(</span><span id="var">$output</span><span id="braces">)</span> = <span id="sqStr">''</span>;

	<span id="comment"># Get the bed annotations</span><br />    <span id="perlKey">if</span> <span id="braces">(</span> <span id="perlFunc">defined</span> <span id="var">$head</span> and <span id="braces">(</span><span id="var">$head</span> <span id="perlKey">eq</span> <span id="sqStr">'only'</span><span id="braces">)</span> <span id="braces">)</span> <span id="braces">{</span> <span id="comment"># get only the head of bed track</span><br />    
	    <span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$position</span> =~ <span id="regExp">/^chr([^\:]*):([^\-]*)-([^\$]*)$/</span> <span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$chromosome</span><span id="braces">)</span> = <span id="var">$1</span>;
			<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$start</span><span id="braces">)</span> = <span id="var">$2</span>;
			<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$end</span><span id="braces">)</span> = <span id="var">$3</span>;
	       	<span id="var">$output</span> .=	<span id="dqStr">"browser pack ensGene ccdsGene\n"</span>.
						<span id="dqStr">"track name=Empty description='' visibility=0 color='255,255,255'\n"</span>.
						<span id="dqStr">"chr$chromosome\t$start\t$end\n"</span>;
	    <span id="braces">}</span>
	<span id="braces">}</span>
    <span id="perlKey">elsif</span> <span id="braces">(</span> <span id="perlFunc">defined</span> <span id="var">$head</span> and <span id="braces">(</span><span id="braces">(</span><span id="var">$head</span> <span id="perlKey">eq</span> <span id="sqStr">'yes'</span><span id="braces">)</span> or <span id="braces">(</span><span id="var">$head</span> <span id="perlKey">eq</span> <span id="sqStr">'no'</span><span id="braces">)</span><span id="braces">)</span> and
			<span id="perlFunc">defined</span> <span id="var">$source</span> and <span id="braces">(</span><span id="var">$source</span> <span id="perlKey">ne</span> <span id="sqStr">''</span><span id="braces">)</span> and 
				<span id="braces">(</span>
					<span id="braces">(</span><span id="var">$source</span> <span id="perlKey">eq</span> <span id="sqStr">'all'</span><span id="braces">)</span> or 
					<span id="braces">(</span><span id="var">$source</span> =~ <span id="regExp">/appris/</span><span id="braces">)</span> or
					<span id="braces">(</span><span id="var">$source</span> =~ <span id="regExp">/firestar/</span><span id="braces">)</span> or
					<span id="braces">(</span><span id="var">$source</span> =~ <span id="regExp">/matador3d/</span><span id="braces">)</span> or
					<span id="braces">(</span><span id="var">$source</span> =~ <span id="regExp">/inertia_corsair/</span><span id="braces">)</span> or
					<span id="braces">(</span><span id="var">$source</span> =~ <span id="regExp">/spade/</span><span id="braces">)</span> or
					<span id="braces">(</span><span id="var">$source</span> =~ <span id="regExp">/corsair/</span><span id="braces">)</span> or
					<span id="braces">(</span><span id="var">$source</span> =~ <span id="regExp">/inertia/</span><span id="braces">)</span> or
					<span id="braces">(</span><span id="var">$source</span> =~ <span id="regExp">/crash/</span><span id="braces">)</span> or
					<span id="braces">(</span><span id="var">$source</span> =~ <span id="regExp">/thump/</span><span id="braces">)</span> or
					<span id="braces">(</span><span id="var">$source</span> =~ <span id="regExp">/cexonic/</span><span id="braces">)</span>
				<span id="braces">)</span>
	<span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$feature</span> and <span id="braces">(</span><span id="perlFunc">ref</span><span id="braces">(</span><span id="var">$feature</span><span id="braces">)</span> <span id="perlKey">ne</span> <span id="sqStr">'ARRAY'</span><span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
	    	<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$feature</span>-&gt;<span id="method">isa</span><span id="braces">(</span><span id="dqStr">"APPRIS::Gene"</span><span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$transcript</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$feature</span>-&gt;<span id="method">transcripts</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
					<span id="method">get_trans_annotations</span><span id="braces">(</span><span id="var">$transcript</span>, <span id="var">$position</span>, <span id="var">$source</span><span id="braces">)</span>;
				<span id="braces">}</span>
	    	<span id="braces">}</span>
	    	<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$feature</span>-&gt;<span id="method">isa</span><span id="braces">(</span><span id="dqStr">"APPRIS::Transcript"</span><span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
	    		<span id="method">get_trans_annotations</span><span id="braces">(</span><span id="var">$feature</span>, <span id="var">$position</span>, <span id="var">$source</span><span id="braces">)</span>;
	    	<span id="braces">}</span>
	    	<span id="perlKey">else</span> <span id="braces">{</span>
				<span id="method">throw</span><span id="braces">(</span><span id="sqStr">'Argument must be an APPRIS::Gene or APPRIS::Transcript'</span><span id="braces">)</span>;
	    	<span id="braces">}</span>
	    <span id="braces">}</span>
		<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$feature</span> and <span id="braces">(</span><span id="perlFunc">ref</span><span id="braces">(</span><span id="var">$feature</span><span id="braces">)</span> <span id="perlKey">eq</span> <span id="sqStr">'ARRAY'</span><span id="braces">)</span> <span id="braces">)</span> <span id="braces">{</span> <span id="comment"># in the case that we have a list of objects</span><br />	    	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$feat</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$feature</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
		    	<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$feat</span>-&gt;<span id="method">isa</span><span id="braces">(</span><span id="dqStr">"APPRIS::Gene"</span><span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
					<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$transcript</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$feat</span>-&gt;<span id="method">transcripts</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
			    		<span id="method">get_trans_annotations</span><span id="braces">(</span><span id="var">$transcript</span>, <span id="var">$position</span>, <span id="var">$source</span><span id="braces">)</span>;
					<span id="braces">}</span>
		    	<span id="braces">}</span>
		    	<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$feat</span>-&gt;<span id="method">isa</span><span id="braces">(</span><span id="dqStr">"APPRIS::Transcript"</span><span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
		    		<span id="method">get_trans_annotations</span><span id="braces">(</span><span id="var">$feature</span>, <span id="var">$position</span>, <span id="var">$source</span><span id="braces">)</span>;
		    	<span id="braces">}</span>
		    	<span id="perlKey">else</span> <span id="braces">{</span>
					<span id="method">throw</span><span id="braces">(</span><span id="sqStr">'Argument must be an APPRIS::Gene or APPRIS::Transcript'</span><span id="braces">)</span>;
		    	<span id="braces">}</span>    		
	    	<span id="braces">}</span>
		<span id="braces">}</span>
	    <span id="perlKey">else</span> <span id="braces">{</span>
			<span id="method">throw</span><span id="braces">(</span><span id="sqStr">'Argument must be define'</span><span id="braces">)</span>;
	   	<span id="braces">}</span>
	   	
		<span id="var">$output</span> .= <span id="dqStr">"browser pack ensGene ccdsGene\n"</span> <span id="perlKey">if</span> <span id="braces">(</span><span id="var">$head</span> <span id="perlKey">eq</span> <span id="sqStr">'yes'</span><span id="braces">)</span>;
		<span id="var">$output</span> .= <span id="method">print_annotations</span><span id="braces">(</span><span id="var">$BED_TRACKS</span><span id="braces">)</span>;
    <span id="braces">}</span>
    <span id="perlKey">else</span> <span id="braces">{</span>
		<span id="method">throw</span><span id="braces">(</span><span id="sqStr">'Arguments must be define'</span><span id="braces">)</span>;
    <span id="braces">}</span>
    
    <span id="comment"># Print output</span><br />	<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$output</span> <span id="perlKey">ne</span> <span id="sqStr">''</span> <span id="braces">)</span> <span id="braces">{</span>
		<span id="var">$output</span> =
			<span id="dqStr">"# --------------------------------------------------------------------------------------#\n"</span>.
			<span id="dqStr">"# Date: <span id="var">$date</span>                                                                     #\n"</span>.
			<span id="dqStr">"# Version: <span id="var">$version</span>                                                                    #\n"</span>.
			<span id="dqStr">"# Description: Annotations for determining principal splice isoforms (APPRIS)           #\n"</span>.
			<span id="dqStr">"# note: the start values of tracks are -1 due the UCSC Genome Growser does not so good. #\n"</span>.          
			<span id="dqStr">"# --------------------------------------------------------------------------------------#\n"</span>.
			<span id="dqStr">"browser position <span id="var">$position</span>"</span>.<span id="dqStr">"\n"</span>.
			<span id="dqStr">"browser pix 800"</span>.<span id="dqStr">"\n"</span>.
			<span id="dqStr">"browser hide all"</span>.<span id="dqStr">"\n"</span>.

			<span id="var">$output</span>;
	<span id="braces">}</span>
	<span id="perlKey">return</span> <span id="var">$output</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE5" id="CODE5"></a>get_appris_annotations</td><td ><a href="#POD2">description</a></td><td ><a href="#CODE4">prev</a></td><td ><a href="#CODE6">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_appris_annotations</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$transcript_id</span>, <span id="var">$feature</span>, <span id="var">$ref_output</span><span id="braces">)</span> = <span id="var">@_</span>;

	<span id="comment"># Get annotations</span><br /> 	<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$feature</span>-&gt;<span id="method">analysis</span> <span id="braces">)</span> <span id="braces">{</span>
 		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$analysis</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">analysis</span>;
 		<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$analysis</span>-&gt;<span id="method">appris</span> <span id="braces">)</span> <span id="braces">{</span>
	 		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$method</span><span id="braces">)</span> = <span id="var">$analysis</span>-&gt;<span id="method">appris</span>;
			<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$method</span>-&gt;<span id="method">principal_isoform</span> and <span id="braces">(</span><span id="var">$method</span>-&gt;<span id="method">principal_isoform</span> <span id="perlKey">eq</span> <span id="var">$APPRIS</span>::<span id="module">Utils::Constant::OK_LABEL</span><span id="braces">)</span> <span id="braces">)</span> <span id="braces">{</span>
				<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$feature</span>-&gt;<span id="method">exons</span> <span id="braces">)</span> <span id="braces">{</span>
					<span id="comment"># get initial data					</span><br />					<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$exon_list</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">exons</span>;
					<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$num_exons</span><span id="braces">)</span> = <span id="perlFunc">scalar</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$exon_list</span><span id="braces">}</span><span id="braces">)</span>;
					<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$trans_chr</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">chromosome</span>;
					<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$trans_start</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">start</span>;
					<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$trans_end</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">end</span>;
					<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$trans_strand</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">strand</span>;
					<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$score</span><span id="braces">)</span> = 0;
					<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$thick_start</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">start</span>;
					<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$thick_end</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">end</span>;
					<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$color</span><span id="braces">)</span> = 0;
					<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$blocks</span><span id="braces">)</span> = <span id="var">$num_exons</span>;					
					<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$feature</span>-&gt;<span id="method">translate</span> and <span id="var">$feature</span>-&gt;<span id="method">translate</span>-&gt;<span id="method">cds</span> <span id="braces">)</span> <span id="braces">{</span>
						<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$cds_list</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">translate</span>-&gt;<span id="method">cds</span>;
						<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$num_cds</span><span id="braces">)</span> = <span id="perlFunc">scalar</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$cds_list</span><span id="braces">}</span><span id="braces">)</span>;						
						<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$trans_strand</span> <span id="perlKey">eq</span> <span id="sqStr">'-'</span><span id="braces">)</span> <span id="braces">{</span>
							<span id="var">$thick_start</span> = <span id="var">$cds_list</span>-&gt;<span id="braces">[</span><span id="var">$num_cds</span>-1<span id="braces">]</span>-&gt;<span id="method">start</span>;
							<span id="var">$thick_end</span> = <span id="var">$cds_list</span>-&gt;<span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="method">end</span>;
						<span id="braces">}</span>
						<span id="perlKey">else</span> <span id="braces">{</span>
							<span id="var">$thick_start</span> = <span id="var">$cds_list</span>-&gt;<span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="method">start</span>; 
							<span id="var">$thick_end</span> = <span id="var">$cds_list</span>-&gt;<span id="braces">[</span><span id="var">$num_cds</span>-1<span id="braces">]</span>-&gt;<span id="method">end</span>;
						<span id="braces">}</span>			
					<span id="braces">}</span>
					<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$data</span><span id="braces">)</span> = <span id="braces">{</span>
							<span id="sqStr">'chr'</span>			=&gt; <span id="var">$trans_chr</span>,
							<span id="sqStr">'name'</span>			=&gt; <span id="var">$transcript_id</span>,
							<span id="sqStr">'start'</span>			=&gt; <span id="var">$trans_start</span>,
							<span id="sqStr">'end'</span>			=&gt; <span id="var">$trans_end</span>,
							<span id="sqStr">'strand'</span>		=&gt; <span id="var">$trans_strand</span>,
							<span id="sqStr">'score'</span>			=&gt; <span id="var">$score</span>,
							<span id="sqStr">'thick_start'</span>	=&gt; <span id="var">$thick_start</span>,
							<span id="sqStr">'thick_end'</span>		=&gt; <span id="var">$thick_end</span>,			
							<span id="sqStr">'color'</span>			=&gt; <span id="var">$color</span>,
							<span id="sqStr">'blocks'</span>		=&gt; <span id="var">$blocks</span>
					<span id="braces">}</span>;
					<span id="comment"># get block annotations</span><br />					<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$exon</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$exon_list</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
						<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$pos_start</span><span id="braces">)</span> = <span id="var">$exon</span>-&gt;<span id="method">start</span>;
						<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$pos_end</span><span id="braces">)</span> = <span id="var">$exon</span>-&gt;<span id="method">end</span>;
						<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$pos_strand</span><span id="braces">)</span> = <span id="var">$exon</span>-&gt;<span id="method">strand</span>;
						<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$trans_strand</span> <span id="perlKey">eq</span> <span id="sqStr">'-'</span><span id="braces">)</span> <span id="braces">{</span>
							<span id="var">$pos_start</span> = <span id="var">$exon</span>-&gt;<span id="method">end</span>;
							<span id="var">$pos_end</span> = <span id="var">$exon</span>-&gt;<span id="method">start</span>;
						<span id="braces">}</span>
						<span id="perlKey">else</span> <span id="braces">{</span>
							<span id="var">$pos_start</span> = <span id="var">$exon</span>-&gt;<span id="method">start</span>;
							<span id="var">$pos_end</span> = <span id="var">$exon</span>-&gt;<span id="method">end</span>;
						<span id="braces">}</span>
						<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$init</span>, <span id="var">$length</span><span id="braces">)</span> = <span id="method">get_block_from_exon</span><span id="braces">(</span><span id="var">$pos_start</span>, <span id="var">$pos_end</span>, <span id="var">$pos_strand</span>, <span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'start'</span><span id="braces">}</span>, <span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'end'</span><span id="braces">}</span><span id="braces">)</span>;
						<span id="perlFunc">push</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'block_starts'</span><span id="braces">}</span><span id="braces">}</span>, <span id="var">$init</span><span id="braces">)</span>;
						<span id="perlFunc">push</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'block_sizes'</span><span id="braces">}</span><span id="braces">}</span>, <span id="var">$length</span><span id="braces">)</span>;
					<span id="braces">}</span>		
					<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$method</span>-&gt;<span id="method">source</span> and <span id="braces">(</span><span id="var">$method</span>-&gt;<span id="method">source</span> <span id="perlKey">eq</span> <span id="sqStr">'vertebrate_signal'</span><span id="braces">)</span> <span id="braces">)</span> <span id="braces">{</span>
						$<span id="braces">{</span><span id="var">$ref_output</span><span id="braces">}</span>-&gt;<span id="braces">[</span>1<span id="braces">]</span>-&gt;<span id="braces">{</span><span id="sqStr">'body'</span><span id="braces">}</span> .= <span id="method">print_data</span><span id="braces">(</span><span id="var">$data</span><span id="braces">)</span>;								
					<span id="braces">}</span>
					<span id="perlKey">else</span> <span id="braces">{</span>
						$<span id="braces">{</span><span id="var">$ref_output</span><span id="braces">}</span>-&gt;<span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span><span id="sqStr">'body'</span><span id="braces">}</span> .= <span id="method">print_data</span><span id="braces">(</span><span id="var">$data</span><span id="braces">)</span>;								
					<span id="braces">}</span>
				<span id="braces">}</span>
			<span id="braces">}</span>
 		<span id="braces">}</span>
 	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE6" id="CODE6"></a>get_block_from_exon</td><td ><a href="#POD3">description</a></td><td ><a href="#CODE5">prev</a></td><td ><a href="#CODE7">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_block_from_exon</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$pos_start</span>, <span id="var">$pos_end</span>, <span id="var">$exon_strand</span>, <span id="var">$block_start</span>, <span id="var">$block_end</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$init</span>,<span id="var">$length</span><span id="braces">)</span>;
		
<span id="comment">#	my ($residue_start) = abs($pos_start - $block_start);</span><br /><span id="comment">#	my ($residue_size) = abs($pos_end - ($pos_start +1));	</span><br /><span id="comment">#	my ($residue_end) = $residue_start + ($residue_size -1);</span><br /><span id="comment">#print DATA_7 &quot;\nRES_START: $residue_start = abs($pos_start - $block_start)\n&quot;;</span><br /><span id="comment">#print DATA_7 &quot;\nRES_SIZE: $residue_size = abs($pos_end - ($pos_start +1))\n&quot;;</span><br /><span id="comment">#print DATA_7 &quot;\nRES_END: $residue_end = $residue_start + ($residue_size -1)\n&quot;;</span><br />	
	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$residue_start</span><span id="braces">)</span>;
	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$residue_size</span><span id="braces">)</span>;
	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$residue_end</span><span id="braces">)</span>;
	<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$exon_strand</span> <span id="perlKey">eq</span> <span id="sqStr">'-'</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="var">$residue_start</span> = <span id="perlFunc">abs</span><span id="braces">(</span><span id="var">$pos_end</span> - <span id="var">$block_start</span><span id="braces">)</span>;
		<span id="var">$residue_size</span> = <span id="perlFunc">abs</span><span id="braces">(</span><span id="var">$pos_end</span> - <span id="var">$pos_start</span><span id="braces">)</span> +1;
		<span id="comment">#$residue_end = $residue_start + ($residue_size -1);</span><br />		
<span id="comment">#print DATA_7 &quot;\nRES_START: residue_start = abs(pos_end - block_start): $residue_start = abs($pos_end - $block_start)\n&quot;;</span><br /><span id="comment">#print DATA_7 &quot;\nRES_SIZE: residue_size = abs(pos_end - (pos_start +1)): $residue_size = abs($pos_end - ($pos_start +1))\n&quot;;</span><br /><span id="comment">#print DATA_7 &quot;\nRES_END: $residue_end = $residue_start + ($residue_size -1)\n&quot;;</span><br />	<span id="braces">}</span> <span id="perlKey">else</span> <span id="braces">{</span>
		<span id="var">$residue_start</span> = <span id="perlFunc">abs</span><span id="braces">(</span><span id="var">$pos_start</span> - <span id="var">$block_start</span><span id="braces">)</span>;
		<span id="var">$residue_size</span> = <span id="perlFunc">abs</span><span id="braces">(</span><span id="var">$pos_start</span> - <span id="var">$pos_end</span><span id="braces">)</span> +1;
		<span id="comment">#$residue_end = $residue_start + ($residue_size -1);</span><br />		
<span id="comment">#print DATA_7 &quot;\nRES_START: residue_start = abs(pos_start - block_start): $residue_start = abs($pos_start - $block_start)\n&quot;;</span><br /><span id="comment">#print DATA_7 &quot;\nRES_SIZE: residue_size = abs((pos_start+1) - pos_end): $residue_size = abs(($pos_start+1) - $pos_end)\n&quot;;</span><br /><span id="comment">#print DATA_7 &quot;\nRES_END: $residue_end = $residue_start + ($residue_size -1)\n&quot;;		</span><br />	<span id="braces">}</span>		
	

	<span id="comment">#if ( defined $residue_start and defined $residue_end and defined $residue_size ) {</span><br />	<span id="perlKey">if</span> <span id="braces">(</span> <span id="perlFunc">defined</span> <span id="var">$residue_start</span> and <span id="perlFunc">defined</span> <span id="var">$residue_size</span> <span id="braces">)</span> <span id="braces">{</span>
		<span id="var">$length</span> = <span id="var">$residue_size</span>;
		<span id="var">$init</span> = <span id="var">$residue_start</span>;
	<span id="braces">}</span>
	<span id="perlKey">return</span> <span id="braces">(</span><span id="var">$init</span>, <span id="var">$length</span><span id="braces">)</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE7" id="CODE7"></a>get_cexonic_annotations</td><td ><a href="#POD4">description</a></td><td ><a href="#CODE6">prev</a></td><td ><a href="#CODE8">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_cexonic_annotations</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$transcript_id</span>, <span id="var">$feature</span>, <span id="var">$ref_output</span><span id="braces">)</span> = <span id="var">@_</span>;

	<span id="comment"># Get annotations</span><br /> 	<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$feature</span>-&gt;<span id="method">analysis</span> <span id="braces">)</span> <span id="braces">{</span>
 		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$analysis</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">analysis</span>;
 		<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$analysis</span>-&gt;<span id="method">cexonic</span> <span id="braces">)</span> <span id="braces">{</span>
	 		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$method</span><span id="braces">)</span> = <span id="var">$analysis</span>-&gt;<span id="method">cexonic</span>;
			<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$feature</span>-&gt;<span id="method">exons</span> <span id="braces">)</span> <span id="braces">{</span>

<span id="comment">#print STDERR &quot;\nENTRA!!!!!!!!!!!\n&quot;;</span><br /><span id="comment">#open(DATA_7, &quot;&gt;/tmp/data7.log&quot;);</span><br />				
				<span id="comment"># get initial data					</span><br />				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$exon_list</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">exons</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$num_exons</span><span id="braces">)</span> = <span id="perlFunc">scalar</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$exon_list</span><span id="braces">}</span><span id="braces">)</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$trans_chr</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">chromosome</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$trans_start</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">start</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$trans_end</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">end</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$trans_strand</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">strand</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$score</span><span id="braces">)</span> = 0;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$thick_start</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">start</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$thick_end</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">end</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$color</span><span id="braces">)</span> = 0;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$blocks</span><span id="braces">)</span> = <span id="var">$num_exons</span>;					
				<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$feature</span>-&gt;<span id="method">translate</span> and <span id="var">$feature</span>-&gt;<span id="method">translate</span>-&gt;<span id="method">cds</span> <span id="braces">)</span> <span id="braces">{</span>
					<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$cds_list</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">translate</span>-&gt;<span id="method">cds</span>;
					<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$num_cds</span><span id="braces">)</span> = <span id="perlFunc">scalar</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$cds_list</span><span id="braces">}</span><span id="braces">)</span>;						
					<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$trans_strand</span> <span id="perlKey">eq</span> <span id="sqStr">'-'</span><span id="braces">)</span> <span id="braces">{</span>
						<span id="var">$thick_start</span> = <span id="var">$cds_list</span>-&gt;<span id="braces">[</span><span id="var">$num_cds</span>-1<span id="braces">]</span>-&gt;<span id="method">start</span>;
						<span id="var">$thick_end</span> = <span id="var">$cds_list</span>-&gt;<span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="method">end</span>;						
					<span id="braces">}</span>
					<span id="perlKey">else</span> <span id="braces">{</span>
						<span id="var">$thick_start</span> = <span id="var">$cds_list</span>-&gt;<span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="method">start</span>; 
						<span id="var">$thick_end</span> = <span id="var">$cds_list</span>-&gt;<span id="braces">[</span><span id="var">$num_cds</span>-1<span id="braces">]</span>-&gt;<span id="method">end</span>;
					<span id="braces">}</span>
<span id="comment">#print DATA_7 &quot;\nCDS:\n&quot;.Dumper($cds_list).&quot;\n&quot;;</span><br />
				<span id="braces">}</span>
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$data</span><span id="braces">)</span> = <span id="braces">{</span>
						<span id="sqStr">'chr'</span>			=&gt; <span id="var">$trans_chr</span>,
						<span id="sqStr">'name'</span>			=&gt; <span id="var">$transcript_id</span>,
						<span id="sqStr">'start'</span>			=&gt; <span id="var">$trans_start</span>,
						<span id="sqStr">'end'</span>			=&gt; <span id="var">$trans_end</span>,
						<span id="sqStr">'strand'</span>		=&gt; <span id="var">$trans_strand</span>,
						<span id="sqStr">'score'</span>			=&gt; <span id="var">$score</span>,
						<span id="sqStr">'thick_start'</span>	=&gt; <span id="var">$thick_start</span>,
						<span id="sqStr">'thick_end'</span>		=&gt; <span id="var">$thick_end</span>,			
						<span id="sqStr">'color'</span>			=&gt; <span id="var">$color</span>,
						<span id="sqStr">'blocks'</span>		=&gt; <span id="var">$blocks</span>
				<span id="braces">}</span>;
<span id="comment">#print DATA_7 &quot;DATA_7: $transcript_id:\n&quot;.Dumper($data).&quot;\n&quot;;</span><br />				
				<span id="comment"># get block annotations</span><br />				<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$exon</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$exon_list</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
<span id="comment">#print DATA_7 &quot;\nRES:\n&quot;.Dumper($exon).&quot;\n&quot;;</span><br />					
					<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$pos_start</span><span id="braces">)</span> = <span id="var">$exon</span>-&gt;<span id="method">start</span>;
					<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$pos_end</span><span id="braces">)</span> = <span id="var">$exon</span>-&gt;<span id="method">end</span>;
					<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$pos_strand</span><span id="braces">)</span> = <span id="var">$exon</span>-&gt;<span id="method">strand</span>;
					<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$trans_strand</span> <span id="perlKey">eq</span> <span id="sqStr">'-'</span><span id="braces">)</span> <span id="braces">{</span>
						<span id="var">$pos_start</span> = <span id="var">$exon</span>-&gt;<span id="method">end</span>;
						<span id="var">$pos_end</span> = <span id="var">$exon</span>-&gt;<span id="method">start</span>;
					<span id="braces">}</span>
					<span id="perlKey">else</span> <span id="braces">{</span>
						<span id="var">$pos_start</span> = <span id="var">$exon</span>-&gt;<span id="method">start</span>;
						<span id="var">$pos_end</span> = <span id="var">$exon</span>-&gt;<span id="method">end</span>;
					<span id="braces">}</span>
<span id="comment">#print DATA_7 &quot;\nPOSITION_2: start: $pos_start end: $pos_end strand: $pos_strand\n&quot;;</span><br /><span id="comment">#print DATA_7 &quot;TRACK_7_2: $transcript_id:\n&quot;.Dumper($data).&quot;\n&quot;;					</span><br />					<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$init</span>, <span id="var">$length</span><span id="braces">)</span> = <span id="method">get_block_from_exon</span><span id="braces">(</span><span id="var">$pos_start</span>, <span id="var">$pos_end</span>, <span id="var">$pos_strand</span>, <span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'start'</span><span id="braces">}</span>, <span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'end'</span><span id="braces">}</span><span id="braces">)</span>;
<span id="comment">#print DATA_7 &quot;\nINIT_2: ($init, $length)\n&quot;;</span><br />					<span id="perlFunc">push</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'block_starts'</span><span id="braces">}</span><span id="braces">}</span>, <span id="var">$init</span><span id="braces">)</span>;
					<span id="perlFunc">push</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'block_sizes'</span><span id="braces">}</span><span id="braces">}</span>, <span id="var">$length</span><span id="braces">)</span>;
				<span id="braces">}</span>

<span id="comment">#print STDERR &quot;DATA: $transcript_id:\n&quot;.Dumper($data).&quot;\n&quot;;					</span><br /><span id="comment">#print STDERR &quot;METHOD:\n&quot;.Dumper($method).&quot;\n&quot;;					</span><br />
				<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$method</span>-&gt;<span id="method">conservation_exon</span> and <span id="braces">(</span><span id="var">$method</span>-&gt;<span id="method">conservation_exon</span> <span id="perlKey">eq</span> <span id="var">$APPRIS</span>::<span id="module">Utils::Constant::UNKNOWN_LABEL</span><span id="braces">)</span> <span id="braces">)</span> <span id="braces">{</span>
					$<span id="braces">{</span><span id="var">$ref_output</span><span id="braces">}</span>-&gt;<span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span><span id="sqStr">'body'</span><span id="braces">}</span> .= <span id="method">print_data</span><span id="braces">(</span><span id="var">$data</span><span id="braces">)</span>;								
				<span id="braces">}</span>
				<span id="perlKey">elsif</span> <span id="braces">(</span> <span id="var">$method</span>-&gt;<span id="method">conservation_exon</span> and <span id="braces">(</span><span id="var">$method</span>-&gt;<span id="method">conservation_exon</span> <span id="perlKey">eq</span> <span id="var">$APPRIS</span>::<span id="module">Utils::Constant::NO_LABEL</span><span id="braces">)</span> <span id="braces">)</span> <span id="braces">{</span>
					$<span id="braces">{</span><span id="var">$ref_output</span><span id="braces">}</span>-&gt;<span id="braces">[</span>1<span id="braces">]</span>-&gt;<span id="braces">{</span><span id="sqStr">'body'</span><span id="braces">}</span> .= <span id="method">print_data</span><span id="braces">(</span><span id="var">$data</span><span id="braces">)</span>;								
				<span id="braces">}</span>
				
<span id="comment">#close(DATA_7);</span><br />
			<span id="braces">}</span>
 		<span id="braces">}</span>
 	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE8" id="CODE8"></a>get_corsair_annotations</td><td ><a href="#POD5">description</a></td><td ><a href="#CODE7">prev</a></td><td ><a href="#CODE9">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_corsair_annotations</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$transcript_id</span>, <span id="var">$feature</span>, <span id="var">$ref_output</span><span id="braces">)</span> = <span id="var">@_</span>;

	<span id="comment"># Get annotations</span><br /> 	<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$feature</span>-&gt;<span id="method">analysis</span> <span id="braces">)</span> <span id="braces">{</span>
 		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$analysis</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">analysis</span>;
 		<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$analysis</span>-&gt;<span id="method">corsair</span> <span id="braces">)</span> <span id="braces">{</span>
	 		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$method</span><span id="braces">)</span> = <span id="var">$analysis</span>-&gt;<span id="method">corsair</span>;
			<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$feature</span>-&gt;<span id="method">exons</span> <span id="braces">)</span> <span id="braces">{</span>

<span id="comment">#open(DATA_7, &quot;&gt;/tmp/data7.log&quot;);</span><br />				
				<span id="comment"># get initial data					</span><br />				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$exon_list</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">exons</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$num_exons</span><span id="braces">)</span> = <span id="perlFunc">scalar</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$exon_list</span><span id="braces">}</span><span id="braces">)</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$trans_chr</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">chromosome</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$trans_start</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">start</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$trans_end</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">end</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$trans_strand</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">strand</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$score</span><span id="braces">)</span> = 0;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$thick_start</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">start</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$thick_end</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">end</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$color</span><span id="braces">)</span> = 0;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$blocks</span><span id="braces">)</span> = <span id="var">$num_exons</span>;					
				<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$feature</span>-&gt;<span id="method">translate</span> and <span id="var">$feature</span>-&gt;<span id="method">translate</span>-&gt;<span id="method">cds</span> <span id="braces">)</span> <span id="braces">{</span>
					<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$cds_list</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">translate</span>-&gt;<span id="method">cds</span>;
					<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$num_cds</span><span id="braces">)</span> = <span id="perlFunc">scalar</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$cds_list</span><span id="braces">}</span><span id="braces">)</span>;						
					<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$trans_strand</span> <span id="perlKey">eq</span> <span id="sqStr">'-'</span><span id="braces">)</span> <span id="braces">{</span>
						<span id="var">$thick_start</span> = <span id="var">$cds_list</span>-&gt;<span id="braces">[</span><span id="var">$num_cds</span>-1<span id="braces">]</span>-&gt;<span id="method">start</span>;
						<span id="var">$thick_end</span> = <span id="var">$cds_list</span>-&gt;<span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="method">end</span>;						
					<span id="braces">}</span>
					<span id="perlKey">else</span> <span id="braces">{</span>
						<span id="var">$thick_start</span> = <span id="var">$cds_list</span>-&gt;<span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="method">start</span>; 
						<span id="var">$thick_end</span> = <span id="var">$cds_list</span>-&gt;<span id="braces">[</span><span id="var">$num_cds</span>-1<span id="braces">]</span>-&gt;<span id="method">end</span>;
					<span id="braces">}</span>
<span id="comment">#print DATA_7 &quot;\nCDS:\n&quot;.Dumper($cds_list).&quot;\n&quot;;</span><br />
				<span id="braces">}</span>
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$data</span><span id="braces">)</span> = <span id="braces">{</span>
						<span id="sqStr">'chr'</span>			=&gt; <span id="var">$trans_chr</span>,
						<span id="sqStr">'name'</span>			=&gt; <span id="var">$transcript_id</span>,
						<span id="sqStr">'start'</span>			=&gt; <span id="var">$trans_start</span>,
						<span id="sqStr">'end'</span>			=&gt; <span id="var">$trans_end</span>,
						<span id="sqStr">'strand'</span>		=&gt; <span id="var">$trans_strand</span>,
						<span id="sqStr">'score'</span>			=&gt; <span id="var">$score</span>,
						<span id="sqStr">'thick_start'</span>	=&gt; <span id="var">$thick_start</span>,
						<span id="sqStr">'thick_end'</span>		=&gt; <span id="var">$thick_end</span>,			
						<span id="sqStr">'color'</span>			=&gt; <span id="var">$color</span>,
						<span id="sqStr">'blocks'</span>		=&gt; <span id="var">$blocks</span>
				<span id="braces">}</span>;
<span id="comment">#print DATA_7 &quot;DATA_7: $transcript_id:\n&quot;.Dumper($data).&quot;\n&quot;;</span><br />				
				<span id="comment"># get block annotations</span><br />				<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$exon</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$exon_list</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
<span id="comment">#print DATA_7 &quot;\nRES:\n&quot;.Dumper($exon).&quot;\n&quot;;</span><br />					
					<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$pos_start</span><span id="braces">)</span> = <span id="var">$exon</span>-&gt;<span id="method">start</span>;
					<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$pos_end</span><span id="braces">)</span> = <span id="var">$exon</span>-&gt;<span id="method">end</span>;
					<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$pos_strand</span><span id="braces">)</span> = <span id="var">$exon</span>-&gt;<span id="method">strand</span>;
					<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$trans_strand</span> <span id="perlKey">eq</span> <span id="sqStr">'-'</span><span id="braces">)</span> <span id="braces">{</span>
						<span id="var">$pos_start</span> = <span id="var">$exon</span>-&gt;<span id="method">end</span>;
						<span id="var">$pos_end</span> = <span id="var">$exon</span>-&gt;<span id="method">start</span>;
					<span id="braces">}</span>
					<span id="perlKey">else</span> <span id="braces">{</span>
						<span id="var">$pos_start</span> = <span id="var">$exon</span>-&gt;<span id="method">start</span>;
						<span id="var">$pos_end</span> = <span id="var">$exon</span>-&gt;<span id="method">end</span>;
					<span id="braces">}</span>
<span id="comment">#print DATA_7 &quot;\nPOSITION_2: start: $pos_start end: $pos_end strand: $pos_strand\n&quot;;</span><br /><span id="comment">#print DATA_7 &quot;TRACK_7_2: $transcript_id:\n&quot;.Dumper($data).&quot;\n&quot;;					</span><br />					<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$init</span>, <span id="var">$length</span><span id="braces">)</span> = <span id="method">get_block_from_exon</span><span id="braces">(</span><span id="var">$pos_start</span>, <span id="var">$pos_end</span>, <span id="var">$pos_strand</span>, <span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'start'</span><span id="braces">}</span>, <span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'end'</span><span id="braces">}</span><span id="braces">)</span>;
<span id="comment">#print DATA_7 &quot;\nINIT_2: ($init, $length)\n&quot;;</span><br />					<span id="perlFunc">push</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'block_starts'</span><span id="braces">}</span><span id="braces">}</span>, <span id="var">$init</span><span id="braces">)</span>;
					<span id="perlFunc">push</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'block_sizes'</span><span id="braces">}</span><span id="braces">}</span>, <span id="var">$length</span><span id="braces">)</span>;
				<span id="braces">}</span>		
				<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$method</span>-&gt;<span id="method">vertebrate_signal</span> and <span id="braces">(</span><span id="var">$method</span>-&gt;<span id="method">vertebrate_signal</span> <span id="perlKey">eq</span> <span id="var">$APPRIS</span>::<span id="module">Utils::Constant::OK_LABEL</span><span id="braces">)</span> <span id="braces">)</span> <span id="braces">{</span>
					$<span id="braces">{</span><span id="var">$ref_output</span><span id="braces">}</span>-&gt;<span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span><span id="sqStr">'body'</span><span id="braces">}</span> .= <span id="method">print_data</span><span id="braces">(</span><span id="var">$data</span><span id="braces">)</span>;								
				<span id="braces">}</span>
				<span id="perlKey">elsif</span> <span id="braces">(</span> <span id="var">$method</span>-&gt;<span id="method">vertebrate_signal</span> and <span id="braces">(</span><span id="var">$method</span>-&gt;<span id="method">vertebrate_signal</span> <span id="perlKey">eq</span> <span id="var">$APPRIS</span>::<span id="module">Utils::Constant::UNKNOWN_LABEL</span><span id="braces">)</span> <span id="braces">)</span> <span id="braces">{</span>
					$<span id="braces">{</span><span id="var">$ref_output</span><span id="braces">}</span>-&gt;<span id="braces">[</span>1<span id="braces">]</span>-&gt;<span id="braces">{</span><span id="sqStr">'body'</span><span id="braces">}</span> .= <span id="method">print_data</span><span id="braces">(</span><span id="var">$data</span><span id="braces">)</span>;								
				<span id="braces">}</span>
				<span id="comment">#elsif ( $method-&gt;vertebrate_signal and ($method-&gt;vertebrate_signal eq $APPRIS::Utils::Constant::NO_LABEL) ) {</span><br />				<span id="comment">#	${$ref_output}-&gt;[2]-&gt;{'body'} .= print_data($data);								</span><br />				<span id="comment">#}</span><br />				
<span id="comment">#close(DATA_7);</span><br />
			<span id="braces">}</span>
 		<span id="braces">}</span>
 	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE9" id="CODE9"></a>get_crash_annotations</td><td ><a href="#POD6">description</a></td><td ><a href="#CODE8">prev</a></td><td ><a href="#CODE10">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_crash_annotations</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$transcript_id</span>, <span id="var">$feature</span>, <span id="var">$ref_output</span><span id="braces">)</span> = <span id="var">@_</span>;

	<span id="comment"># Get annotations</span><br /> 	<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$feature</span>-&gt;<span id="method">analysis</span> <span id="braces">)</span> <span id="braces">{</span>
 		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$analysis</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">analysis</span>;
 		<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$analysis</span>-&gt;<span id="method">crash</span> <span id="braces">)</span> <span id="braces">{</span>
	 		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$method</span><span id="braces">)</span> = <span id="var">$analysis</span>-&gt;<span id="method">crash</span>;
	 		<span id="comment"># get residue annotations</span><br />			<span id="perlKey">if</span> <span id="braces">(</span> <span id="perlFunc">defined</span> <span id="var">$method</span>-&gt;<span id="method">regions</span> <span id="braces">)</span> <span id="braces">{</span>

<span id="comment">#open(DATA_7_F, &quot;&gt;/tmp/data7.firestar.log&quot;);</span><br />
				<span id="comment"># get initial data</span><br />				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$res_list</span><span id="braces">)</span> = <span id="var">$method</span>-&gt;<span id="method">regions</span>;				
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$num_res</span><span id="braces">)</span> = <span id="perlFunc">scalar</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$res_list</span><span id="braces">}</span><span id="braces">)</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$trans_chr</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">chromosome</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$trans_start</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">start</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$trans_end</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">end</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$trans_strand</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">strand</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$score</span><span id="braces">)</span> = 0;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$thick_start</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">start</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$thick_end</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">end</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$color</span><span id="braces">)</span> = 0;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$blocks</span><span id="braces">)</span> = 0;
				<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$trans_strand</span> <span id="perlKey">eq</span> <span id="sqStr">'-'</span> <span id="braces">)</span> <span id="braces">{</span>
					<span id="var">$trans_start</span> = <span id="var">$res_list</span>-&gt;<span id="braces">[</span><span id="var">$num_res</span>-1<span id="braces">]</span>-&gt;<span id="method">start</span>;
					<span id="var">$trans_end</span> = <span id="var">$res_list</span>-&gt;<span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="method">end</span>;
					<span id="var">$thick_start</span> = <span id="var">$trans_start</span>;
					<span id="var">$thick_end</span> = <span id="var">$trans_end</span>;
				<span id="braces">}</span>
				<span id="perlKey">else</span> <span id="braces">{</span>
					<span id="var">$trans_start</span> = <span id="var">$res_list</span>-&gt;<span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="method">start</span>; 
					<span id="var">$trans_end</span> = <span id="var">$res_list</span>-&gt;<span id="braces">[</span><span id="var">$num_res</span>-1<span id="braces">]</span>-&gt;<span id="method">end</span>;
					<span id="var">$thick_start</span> = <span id="var">$trans_start</span>;
					<span id="var">$thick_end</span> = <span id="var">$trans_end</span>;
				<span id="braces">}</span>
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$data</span><span id="braces">)</span> = <span id="braces">{</span>
						<span id="sqStr">'chr'</span>			=&gt; <span id="var">$trans_chr</span>,
						<span id="sqStr">'name'</span>			=&gt; <span id="var">$transcript_id</span>,
						<span id="sqStr">'start'</span>			=&gt; <span id="var">$trans_start</span>,
						<span id="sqStr">'end'</span>			=&gt; <span id="var">$trans_end</span>,
						<span id="sqStr">'strand'</span>		=&gt; <span id="var">$trans_strand</span>,
						<span id="sqStr">'score'</span>			=&gt; <span id="var">$score</span>,
						<span id="sqStr">'thick_start'</span>	=&gt; <span id="var">$thick_start</span>,
						<span id="sqStr">'thick_end'</span>		=&gt; <span id="var">$thick_end</span>,			
						<span id="sqStr">'color'</span>			=&gt; <span id="var">$color</span>,
						<span id="sqStr">'blocks'</span>		=&gt; <span id="var">$blocks</span>
				<span id="braces">}</span>;
<span id="comment">#print DATA_7_F &quot;RES_LIST: $transcript_id:\n&quot;.Dumper($res_list).&quot;\n&quot;;				</span><br /><span id="comment">#print DATA_7_F &quot;DATA_7: $transcript_id:\n&quot;.Dumper($data).&quot;\n&quot;;</span><br />				
				<span id="comment"># get block annotations</span><br />				<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$feature</span>-&gt;<span id="method">translate</span> and <span id="var">$feature</span>-&gt;<span id="method">translate</span>-&gt;<span id="method">cds</span> <span id="braces">)</span> <span id="braces">{</span>
					<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$translation</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">translate</span>;
					<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$cds_list</span><span id="braces">)</span> = <span id="var">$translation</span>-&gt;<span id="method">cds</span>;
					<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$num_cds</span><span id="braces">)</span> = <span id="perlFunc">scalar</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$cds_list</span><span id="braces">}</span><span id="braces">)</span>;						
					<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$res</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$res_list</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
						<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$contained_cds</span><span id="braces">)</span> = <span id="var">$translation</span>-&gt;<span id="method">get_overlapping_cds</span><span id="braces">(</span><span id="var">$res</span>-&gt;<span id="method">start</span>, <span id="var">$res</span>-&gt;<span id="method">end</span><span id="braces">)</span>;
						<span id="perlKey">my</span> <span id="braces">(</span><span id="var">@sorted_contained_cds</span><span id="braces">)</span> = @<span id="braces">{</span><span id="var">$contained_cds</span><span id="braces">}</span>;
						<span id="perlKey">for</span> <span id="braces">(</span><span id="perlKey">my</span> <span id="var">$i</span> = 0; <span id="var">$i</span> &lt; <span id="perlFunc">scalar</span><span id="braces">(</span><span id="var">@sorted_contained_cds</span><span id="braces">)</span>; <span id="var">$i</span>++<span id="braces">)</span> <span id="braces">{</span>
							
							<span id="perlKey">if</span> <span id="braces">(</span> <span id="perlFunc">scalar</span><span id="braces">(</span><span id="var">@sorted_contained_cds</span><span id="braces">)</span> == 1 <span id="braces">)</span> <span id="braces">{</span> <span id="comment"># Within one CDS</span><br />								<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$pos_start</span><span id="braces">)</span> = <span id="var">$res</span>-&gt;<span id="method">start</span>;
								<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$pos_end</span><span id="braces">)</span> = <span id="var">$res</span>-&gt;<span id="method">end</span>;
								<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$pos_strand</span><span id="braces">)</span> = <span id="var">$res</span>-&gt;<span id="method">strand</span>;
<span id="comment">#print DATA_7_F &quot;\nPOSITION: start: $pos_start end: $pos_end strand: $pos_strand\n&quot;;								</span><br />								<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$init</span>, <span id="var">$length</span><span id="braces">)</span> = <span id="method">get_block_from_exon</span><span id="braces">(</span><span id="var">$pos_start</span>, <span id="var">$pos_end</span>, <span id="var">$pos_strand</span>, <span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'thick_start'</span><span id="braces">}</span>, <span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'thick_end'</span><span id="braces">}</span><span id="braces">)</span>;
<span id="comment">#print DATA_7_F &quot;\nINIT: ($init, $length)\n&quot;;</span><br />								<span id="perlFunc">push</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'block_starts'</span><span id="braces">}</span><span id="braces">}</span>, <span id="var">$init</span><span id="braces">)</span>;
								<span id="perlFunc">push</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'block_sizes'</span><span id="braces">}</span><span id="braces">}</span>, <span id="var">$length</span><span id="braces">)</span>;
								<span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'blocks'</span><span id="braces">}</span>++;	
								<span id="perlKey">last</span>;
							<span id="braces">}</span>
							<span id="perlKey">else</span> <span id="braces">{</span> <span id="comment"># Within several CDS</span><br />								<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$cds_out</span><span id="braces">)</span> = <span id="var">$sorted_contained_cds</span><span id="braces">[</span><span id="var">$i</span><span id="braces">]</span>;
								<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$pos_start</span><span id="braces">)</span> = <span id="var">$cds_out</span>-&gt;<span id="method">start</span>;
								<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$pos_end</span><span id="braces">)</span> = <span id="var">$cds_out</span>-&gt;<span id="method">end</span>;
								<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$pos_strand</span><span id="braces">)</span> = <span id="var">$cds_out</span>-&gt;<span id="method">strand</span>;				
								<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$i</span>==0 <span id="braces">)</span> <span id="braces">{</span>
									<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$trans_strand</span> <span id="perlKey">eq</span> <span id="sqStr">'-'</span><span id="braces">)</span> <span id="braces">{</span>
										<span id="comment">#$pos_start = $cds_out-&gt;start;</span><br />										<span id="comment">#$pos_end = $res-&gt;end;</span><br />										<span id="var">$pos_start</span> = <span id="var">$res</span>-&gt;<span id="method">end</span>;
										<span id="var">$pos_end</span> = <span id="var">$cds_out</span>-&gt;<span id="method">start</span>;
									<span id="braces">}</span>
									<span id="perlKey">else</span> <span id="braces">{</span>
										<span id="var">$pos_start</span> = <span id="var">$res</span>-&gt;<span id="method">start</span>;
										<span id="var">$pos_end</span> = <span id="var">$cds_out</span>-&gt;<span id="method">end</span>;
									<span id="braces">}</span>
								<span id="braces">}</span>
								<span id="perlKey">elsif</span> <span id="braces">(</span> <span id="var">$i</span> == <span id="perlFunc">scalar</span><span id="braces">(</span><span id="var">@sorted_contained_cds</span><span id="braces">)</span>-1 <span id="braces">)</span> <span id="braces">{</span>
									<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$trans_strand</span> <span id="perlKey">eq</span> <span id="sqStr">'-'</span> <span id="braces">)</span> <span id="braces">{</span>
										<span id="comment">#$pos_start = $res-&gt;start;</span><br />										<span id="comment">#$pos_end = $cds_out-&gt;end;</span><br />										<span id="var">$pos_start</span> = <span id="var">$cds_out</span>-&gt;<span id="method">end</span>;
										<span id="var">$pos_end</span> = <span id="var">$res</span>-&gt;<span id="method">start</span>;
									<span id="braces">}</span>
									<span id="perlKey">else</span> <span id="braces">{</span>
										<span id="var">$pos_start</span> = <span id="var">$cds_out</span>-&gt;<span id="method">start</span>;
										<span id="var">$pos_end</span> = <span id="var">$res</span>-&gt;<span id="method">end</span>;
									<span id="braces">}</span>
								<span id="braces">}</span>
<span id="comment">#print DATA_7_F &quot;\nPOSITION: start: $pos_start end: $pos_end strand: $pos_strand\n&quot;;</span><br />								<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$init</span>, <span id="var">$length</span><span id="braces">)</span> = <span id="method">get_block_from_exon</span><span id="braces">(</span><span id="var">$pos_start</span>, <span id="var">$pos_end</span>, <span id="var">$pos_strand</span>, <span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'thick_start'</span><span id="braces">}</span>, <span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'thick_end'</span><span id="braces">}</span><span id="braces">)</span>;
<span id="comment">#print DATA_7_F &quot;\nINIT: ($init, $length)\n&quot;;</span><br />								<span id="perlFunc">push</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'block_starts'</span><span id="braces">}</span><span id="braces">}</span>, <span id="var">$init</span><span id="braces">)</span>;
								<span id="perlFunc">push</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'block_sizes'</span><span id="braces">}</span><span id="braces">}</span>, <span id="var">$length</span><span id="braces">)</span>;
								<span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'blocks'</span><span id="braces">}</span>++;	
							<span id="braces">}</span>
						<span id="braces">}</span>
					<span id="braces">}</span>
				<span id="braces">}</span>
				<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$method</span>-&gt;<span id="method">peptide_signal</span> and <span id="braces">(</span><span id="var">$method</span>-&gt;<span id="method">peptide_signal</span> <span id="perlKey">eq</span> <span id="var">$APPRIS</span>::<span id="module">Utils::Constant::OK_LABEL</span><span id="braces">)</span> <span id="braces">)</span><span id="braces">{</span>
					$<span id="braces">{</span><span id="var">$ref_output</span><span id="braces">}</span>-&gt;<span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span><span id="sqStr">'body'</span><span id="braces">}</span> .= <span id="method">print_data</span><span id="braces">(</span><span id="var">$data</span><span id="braces">)</span>;								
				<span id="braces">}</span>
				<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$method</span>-&gt;<span id="method">mitochondrial_signal</span> and <span id="braces">(</span><span id="var">$method</span>-&gt;<span id="method">mitochondrial_signal</span> <span id="perlKey">eq</span> <span id="var">$APPRIS</span>::<span id="module">Utils::Constant::OK_LABEL</span><span id="braces">)</span> <span id="braces">)</span><span id="braces">{</span>
					$<span id="braces">{</span><span id="var">$ref_output</span><span id="braces">}</span>-&gt;<span id="braces">[</span>1<span id="braces">]</span>-&gt;<span id="braces">{</span><span id="sqStr">'body'</span><span id="braces">}</span> .= <span id="method">print_data</span><span id="braces">(</span><span id="var">$data</span><span id="braces">)</span>;								
				<span id="braces">}</span>
				
<span id="comment">#close(DATA_7_F);</span><br />			<span id="braces">}</span>
 		<span id="braces">}</span>
 	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE10" id="CODE10"></a>get_firestar_annotations</td><td ><a href="#POD7">description</a></td><td ><a href="#CODE9">prev</a></td><td ><a href="#CODE11">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_firestar_annotations</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$transcript_id</span>, <span id="var">$feature</span>, <span id="var">$ref_output</span><span id="braces">)</span> = <span id="var">@_</span>;

	<span id="comment"># Get annotations</span><br /> 	<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$feature</span>-&gt;<span id="method">analysis</span> <span id="braces">)</span> <span id="braces">{</span>
 		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$analysis</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">analysis</span>;
 		<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$analysis</span>-&gt;<span id="method">firestar</span> <span id="braces">)</span> <span id="braces">{</span>
	 		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$method</span><span id="braces">)</span> = <span id="var">$analysis</span>-&gt;<span id="method">firestar</span>;
	 		<span id="comment"># get residue annotations</span><br />			<span id="perlKey">if</span> <span id="braces">(</span> <span id="perlFunc">defined</span> <span id="var">$method</span>-&gt;<span id="method">residues</span> <span id="braces">)</span> <span id="braces">{</span>

<span id="comment">#open(DATA_7_F, &quot;&gt;/tmp/data7.firestar.log&quot;);</span><br />
				<span id="comment"># get initial data</span><br />				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$res_list</span><span id="braces">)</span> = <span id="var">$method</span>-&gt;<span id="method">residues</span>;				
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$num_res</span><span id="braces">)</span> = <span id="perlFunc">scalar</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$res_list</span><span id="braces">}</span><span id="braces">)</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$trans_chr</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">chromosome</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$trans_start</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">start</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$trans_end</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">end</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$trans_strand</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">strand</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$score</span><span id="braces">)</span> = 0;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$thick_start</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">start</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$thick_end</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">end</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$color</span><span id="braces">)</span> = 0;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$blocks</span><span id="braces">)</span> = 0;
				<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$trans_strand</span> <span id="perlKey">eq</span> <span id="sqStr">'-'</span> <span id="braces">)</span> <span id="braces">{</span>
					<span id="var">$trans_start</span> = <span id="var">$res_list</span>-&gt;<span id="braces">[</span><span id="var">$num_res</span>-1<span id="braces">]</span>-&gt;<span id="method">end</span>;
					<span id="var">$trans_end</span> = <span id="var">$res_list</span>-&gt;<span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="method">start</span>;
					<span id="var">$thick_start</span> = <span id="var">$trans_start</span>;
					<span id="var">$thick_end</span> = <span id="var">$trans_end</span>;
				<span id="braces">}</span>
				<span id="perlKey">else</span> <span id="braces">{</span>
					<span id="var">$trans_start</span> = <span id="var">$res_list</span>-&gt;<span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="method">start</span>; 
					<span id="var">$trans_end</span> = <span id="var">$res_list</span>-&gt;<span id="braces">[</span><span id="var">$num_res</span>-1<span id="braces">]</span>-&gt;<span id="method">end</span>;
					<span id="var">$thick_start</span> = <span id="var">$trans_start</span>;
					<span id="var">$thick_end</span> = <span id="var">$trans_end</span>;
				<span id="braces">}</span>
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$data</span><span id="braces">)</span> = <span id="braces">{</span>
						<span id="sqStr">'chr'</span>			=&gt; <span id="var">$trans_chr</span>,
						<span id="sqStr">'name'</span>			=&gt; <span id="var">$transcript_id</span>,
						<span id="sqStr">'start'</span>			=&gt; <span id="var">$trans_start</span>,
						<span id="sqStr">'end'</span>			=&gt; <span id="var">$trans_end</span>,
						<span id="sqStr">'strand'</span>		=&gt; <span id="var">$trans_strand</span>,
						<span id="sqStr">'score'</span>			=&gt; <span id="var">$score</span>,
						<span id="sqStr">'thick_start'</span>	=&gt; <span id="var">$thick_start</span>,
						<span id="sqStr">'thick_end'</span>		=&gt; <span id="var">$thick_end</span>,			
						<span id="sqStr">'color'</span>			=&gt; <span id="var">$color</span>,
						<span id="sqStr">'blocks'</span>		=&gt; <span id="var">$blocks</span>
				<span id="braces">}</span>;
<span id="comment">#print DATA_7_F &quot;RES_LIST: $transcript_id:\n&quot;.Dumper($res_list).&quot;\n&quot;;				</span><br /><span id="comment">#print DATA_7_F &quot;DATA_7: $transcript_id:\n&quot;.Dumper($data).&quot;\n&quot;;</span><br />				
				<span id="comment"># get block annotations</span><br />				<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$feature</span>-&gt;<span id="method">translate</span> and <span id="var">$feature</span>-&gt;<span id="method">translate</span>-&gt;<span id="method">cds</span> <span id="braces">)</span> <span id="braces">{</span>
					<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$translation</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">translate</span>;
					<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$cds_list</span><span id="braces">)</span> = <span id="var">$translation</span>-&gt;<span id="method">cds</span>;
					<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$num_cds</span><span id="braces">)</span> = <span id="perlFunc">scalar</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$cds_list</span><span id="braces">}</span><span id="braces">)</span>;						
					<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$res</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$res_list</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
						<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$contained_cds</span><span id="braces">)</span> = <span id="var">$translation</span>-&gt;<span id="method">get_overlapping_cds</span><span id="braces">(</span><span id="var">$res</span>-&gt;<span id="method">start</span>, <span id="var">$res</span>-&gt;<span id="method">end</span><span id="braces">)</span>;
						<span id="perlKey">my</span> <span id="braces">(</span><span id="var">@sorted_contained_cds</span><span id="braces">)</span> = @<span id="braces">{</span><span id="var">$contained_cds</span><span id="braces">}</span>;
						<span id="perlKey">for</span> <span id="braces">(</span><span id="perlKey">my</span> <span id="var">$i</span> = 0; <span id="var">$i</span> &lt; <span id="perlFunc">scalar</span><span id="braces">(</span><span id="var">@sorted_contained_cds</span><span id="braces">)</span>; <span id="var">$i</span>++<span id="braces">)</span> <span id="braces">{</span>
							
							<span id="perlKey">if</span> <span id="braces">(</span> <span id="perlFunc">scalar</span><span id="braces">(</span><span id="var">@sorted_contained_cds</span><span id="braces">)</span> == 1 <span id="braces">)</span> <span id="braces">{</span> <span id="comment"># Within one CDS</span><br />								<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$pos_start</span><span id="braces">)</span> = <span id="var">$res</span>-&gt;<span id="method">start</span>;
								<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$pos_end</span><span id="braces">)</span> = <span id="var">$res</span>-&gt;<span id="method">end</span>;
								<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$pos_strand</span><span id="braces">)</span> = <span id="var">$res</span>-&gt;<span id="method">strand</span>;
<span id="comment">#print DATA_7_F &quot;\nPOSITION: start: $pos_start end: $pos_end strand: $pos_strand\n&quot;;								</span><br />								<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$init</span>, <span id="var">$length</span><span id="braces">)</span> = <span id="method">get_block_from_exon</span><span id="braces">(</span><span id="var">$pos_start</span>, <span id="var">$pos_end</span>, <span id="var">$pos_strand</span>, <span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'thick_start'</span><span id="braces">}</span>, <span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'thick_end'</span><span id="braces">}</span><span id="braces">)</span>;
<span id="comment">#print DATA_7_F &quot;\nINIT: ($init, $length)\n&quot;;</span><br />								<span id="perlFunc">push</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'block_starts'</span><span id="braces">}</span><span id="braces">}</span>, <span id="var">$init</span><span id="braces">)</span>;
								<span id="perlFunc">push</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'block_sizes'</span><span id="braces">}</span><span id="braces">}</span>, <span id="var">$length</span><span id="braces">)</span>;
								<span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'blocks'</span><span id="braces">}</span>++;	
								<span id="perlKey">last</span>;
							<span id="braces">}</span>
							<span id="perlKey">else</span> <span id="braces">{</span> <span id="comment"># Within several CDS</span><br />								<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$cds_out</span><span id="braces">)</span> = <span id="var">$sorted_contained_cds</span><span id="braces">[</span><span id="var">$i</span><span id="braces">]</span>;
								<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$pos_start</span><span id="braces">)</span> = <span id="var">$cds_out</span>-&gt;<span id="method">start</span>;
								<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$pos_end</span><span id="braces">)</span> = <span id="var">$cds_out</span>-&gt;<span id="method">end</span>;
								<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$pos_strand</span><span id="braces">)</span> = <span id="var">$cds_out</span>-&gt;<span id="method">strand</span>;				
								<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$i</span>==0 <span id="braces">)</span> <span id="braces">{</span>
									<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$trans_strand</span> <span id="perlKey">eq</span> <span id="sqStr">'-'</span><span id="braces">)</span> <span id="braces">{</span>
										<span id="var">$pos_start</span> = <span id="var">$cds_out</span>-&gt;<span id="method">start</span>;
										<span id="var">$pos_end</span> = <span id="var">$res</span>-&gt;<span id="method">end</span>;
									<span id="braces">}</span>
									<span id="perlKey">else</span> <span id="braces">{</span>
										<span id="var">$pos_start</span> = <span id="var">$res</span>-&gt;<span id="method">start</span>;
										<span id="var">$pos_end</span> = <span id="var">$cds_out</span>-&gt;<span id="method">end</span>;
									<span id="braces">}</span>
								<span id="braces">}</span>
								<span id="perlKey">elsif</span> <span id="braces">(</span> <span id="var">$i</span> == <span id="perlFunc">scalar</span><span id="braces">(</span><span id="var">@sorted_contained_cds</span><span id="braces">)</span>-1 <span id="braces">)</span> <span id="braces">{</span>
									<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$trans_strand</span> <span id="perlKey">eq</span> <span id="sqStr">'-'</span> <span id="braces">)</span> <span id="braces">{</span>
										<span id="var">$pos_start</span> = <span id="var">$res</span>-&gt;<span id="method">start</span>;
										<span id="var">$pos_end</span> = <span id="var">$cds_out</span>-&gt;<span id="method">end</span>;
									<span id="braces">}</span>
									<span id="perlKey">else</span> <span id="braces">{</span>
										<span id="var">$pos_start</span> = <span id="var">$cds_out</span>-&gt;<span id="method">start</span>;
										<span id="var">$pos_end</span> = <span id="var">$res</span>-&gt;<span id="method">end</span>;
									<span id="braces">}</span>
								<span id="braces">}</span>
<span id="comment">#print DATA_7_F &quot;\nPOSITION: start: $pos_start end: $pos_end strand: $pos_strand\n&quot;;</span><br />								<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$init</span>, <span id="var">$length</span><span id="braces">)</span> = <span id="method">get_block_from_exon</span><span id="braces">(</span><span id="var">$pos_start</span>, <span id="var">$pos_end</span>, <span id="var">$pos_strand</span>, <span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'thick_start'</span><span id="braces">}</span>, <span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'thick_end'</span><span id="braces">}</span><span id="braces">)</span>;
<span id="comment">#print DATA_7_F &quot;\nINIT: ($init, $length)\n&quot;;</span><br />								<span id="perlFunc">push</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'block_starts'</span><span id="braces">}</span><span id="braces">}</span>, <span id="var">$init</span><span id="braces">)</span>;
								<span id="perlFunc">push</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'block_sizes'</span><span id="braces">}</span><span id="braces">}</span>, <span id="var">$length</span><span id="braces">)</span>;
								<span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'blocks'</span><span id="braces">}</span>++;	
							<span id="braces">}</span>
						<span id="braces">}</span>
					<span id="braces">}</span>
				<span id="braces">}</span>
				$<span id="braces">{</span><span id="var">$ref_output</span><span id="braces">}</span>-&gt;<span id="braces">{</span><span id="sqStr">'body'</span><span id="braces">}</span> .= <span id="method">print_data</span><span id="braces">(</span><span id="var">$data</span><span id="braces">)</span>;
				
<span id="comment">#close(DATA_7_F);</span><br />			<span id="braces">}</span>
 		<span id="braces">}</span>
 	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE11" id="CODE11"></a>get_inertia_annotations</td><td ><a href="#POD8">description</a></td><td ><a href="#CODE10">prev</a></td><td ><a href="#CODE12">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_inertia_annotations</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$transcript_id</span>, <span id="var">$feature</span>, <span id="var">$ref_output</span><span id="braces">)</span> = <span id="var">@_</span>;

	<span id="comment"># Get annotations</span><br /> 	<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$feature</span>-&gt;<span id="method">analysis</span> <span id="braces">)</span> <span id="braces">{</span>
 		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$analysis</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">analysis</span>;
 		<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$analysis</span>-&gt;<span id="method">inertia</span> <span id="braces">)</span> <span id="braces">{</span>
	 		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$method</span><span id="braces">)</span> = <span id="var">$analysis</span>-&gt;<span id="method">inertia</span>;
	 		<span id="comment"># get residue annotations</span><br />			<span id="perlKey">if</span> <span id="braces">(</span> <span id="perlFunc">defined</span> <span id="var">$method</span>-&gt;<span id="method">regions</span> <span id="braces">)</span> <span id="braces">{</span>
				<span id="comment"># get the residues with 'neutral_evolution', and 'unusual_evolution' separetly</span><br />				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$res_list</span><span id="braces">)</span> = <span id="var">$method</span>-&gt;<span id="method">regions</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$num_res</span><span id="braces">)</span> = <span id="perlFunc">scalar</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$res_list</span><span id="braces">}</span><span id="braces">)</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$res_evol</span><span id="braces">)</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$res_u_evol</span><span id="braces">)</span>;
				<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$res</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$res_list</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
					<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$res</span>-&gt;<span id="method">unusual_evolution</span> <span id="perlKey">eq</span> <span id="var">$APPRIS</span>::<span id="module">Utils::Constant::UNKNOWN_LABEL</span> <span id="braces">)</span> <span id="braces">{</span>
						<span id="perlFunc">push</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$res_evol</span><span id="braces">}</span>, <span id="var">$res</span><span id="braces">)</span>;
					<span id="braces">}</span>
					<span id="perlKey">elsif</span> <span id="braces">(</span> <span id="var">$res</span>-&gt;<span id="method">unusual_evolution</span> <span id="perlKey">eq</span> <span id="var">$APPRIS</span>::<span id="module">Utils::Constant::NO_LABEL</span> <span id="braces">)</span> <span id="braces">{</span>
						<span id="perlFunc">push</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$res_u_evol</span><span id="braces">}</span>, <span id="var">$res</span><span id="braces">)</span>;
					<span id="braces">}</span>
				<span id="braces">}</span>
<span id="comment">#open(DATA_7, &quot;&gt;/tmp/data7.log&quot;);</span><br />				
				<span id="method">_aux_get_inertia_annotations</span><span id="braces">(</span><span id="sqStr">'neutral_evolution'</span>,
											<span id="var">$transcript_id</span>,
											<span id="var">$feature</span>,
											<span id="var">$res_evol</span>,
											<span id="var">$ref_output</span><span id="braces">)</span>;
				<span id="method">_aux_get_inertia_annotations</span><span id="braces">(</span><span id="sqStr">'unusual_evolution'</span>,
											<span id="var">$transcript_id</span>,
											<span id="var">$feature</span>,
											<span id="var">$res_u_evol</span>,
											<span id="var">$ref_output</span><span id="braces">)</span>;

<span id="comment">#print DATA_7 &quot;\nREPORT:\n&quot;.Dumper($ref_output).&quot;\n&quot;;</span><br /><span id="comment">#close(DATA_7);</span><br />
			<span id="braces">}</span>
 		<span id="braces">}</span>
 	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE12" id="CODE12"></a>get_matador3d_annotations</td><td ><a href="#POD9">description</a></td><td ><a href="#CODE11">prev</a></td><td ><a href="#CODE13">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_matador3d_annotations</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$transcript_id</span>, <span id="var">$feature</span>, <span id="var">$ref_output</span><span id="braces">)</span> = <span id="var">@_</span>;

	<span id="comment"># Get annotations</span><br /> 	<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$feature</span>-&gt;<span id="method">analysis</span> <span id="braces">)</span> <span id="braces">{</span>
 		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$analysis</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">analysis</span>;
 		<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$analysis</span>-&gt;<span id="method">matador3d</span> <span id="braces">)</span> <span id="braces">{</span>
	 		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$method</span><span id="braces">)</span> = <span id="var">$analysis</span>-&gt;<span id="method">matador3d</span>;
	 		<span id="comment"># get residue annotations</span><br />			<span id="perlKey">if</span> <span id="braces">(</span> <span id="perlFunc">defined</span> <span id="var">$method</span>-&gt;<span id="method">alignments</span> <span id="braces">)</span> <span id="braces">{</span>
				<span id="comment"># get initial data</span><br />				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$res_list</span><span id="braces">)</span> = <span id="var">$method</span>-&gt;<span id="method">alignments</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$num_res</span><span id="braces">)</span> = <span id="perlFunc">scalar</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$res_list</span><span id="braces">}</span><span id="braces">)</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$trans_chr</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">chromosome</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$trans_start</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">start</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$trans_end</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">end</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$trans_strand</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">strand</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$score</span><span id="braces">)</span> = 0;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$thick_start</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">start</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$thick_end</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">end</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$color</span><span id="braces">)</span> = 0;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$blocks</span><span id="braces">)</span> = 0;
				<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$trans_strand</span> <span id="perlKey">eq</span> <span id="sqStr">'-'</span> <span id="braces">)</span> <span id="braces">{</span>
					<span id="var">$trans_start</span> = <span id="var">$res_list</span>-&gt;<span id="braces">[</span><span id="var">$num_res</span>-1<span id="braces">]</span>-&gt;<span id="method">end</span>;
					<span id="var">$trans_end</span> = <span id="var">$res_list</span>-&gt;<span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="method">start</span>;
					<span id="var">$thick_start</span> = <span id="var">$trans_start</span>;
					<span id="var">$thick_end</span> = <span id="var">$trans_end</span>;
				<span id="braces">}</span>
				<span id="perlKey">else</span> <span id="braces">{</span>
					<span id="var">$trans_start</span> = <span id="var">$res_list</span>-&gt;<span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="method">start</span>; 
					<span id="var">$trans_end</span> = <span id="var">$res_list</span>-&gt;<span id="braces">[</span><span id="var">$num_res</span>-1<span id="braces">]</span>-&gt;<span id="method">end</span>;
					<span id="var">$thick_start</span> = <span id="var">$trans_start</span>;
					<span id="var">$thick_end</span> = <span id="var">$trans_end</span>;
				<span id="braces">}</span>
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$data</span><span id="braces">)</span> = <span id="braces">{</span>
						<span id="sqStr">'chr'</span>			=&gt; <span id="var">$trans_chr</span>,
						<span id="sqStr">'name'</span>			=&gt; <span id="var">$transcript_id</span>,
						<span id="sqStr">'start'</span>			=&gt; <span id="var">$trans_start</span>,
						<span id="sqStr">'end'</span>			=&gt; <span id="var">$trans_end</span>,
						<span id="sqStr">'strand'</span>		=&gt; <span id="var">$trans_strand</span>,
						<span id="sqStr">'score'</span>			=&gt; <span id="var">$score</span>,
						<span id="sqStr">'thick_start'</span>	=&gt; <span id="var">$thick_start</span>,
						<span id="sqStr">'thick_end'</span>		=&gt; <span id="var">$thick_end</span>,			
						<span id="sqStr">'color'</span>			=&gt; <span id="var">$color</span>,
						<span id="sqStr">'blocks'</span>		=&gt; <span id="var">$blocks</span>
				<span id="braces">}</span>;
				<span id="comment"># get block annotations</span><br />				<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$feature</span>-&gt;<span id="method">translate</span> and <span id="var">$feature</span>-&gt;<span id="method">translate</span>-&gt;<span id="method">cds</span> <span id="braces">)</span> <span id="braces">{</span>
					<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$translation</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">translate</span>;
					<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$cds_list</span><span id="braces">)</span> = <span id="var">$translation</span>-&gt;<span id="method">cds</span>;
					<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$num_cds</span><span id="braces">)</span> = <span id="perlFunc">scalar</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$cds_list</span><span id="braces">}</span><span id="braces">)</span>;						
					<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$res</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$res_list</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
						<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$pos_start</span><span id="braces">)</span> = <span id="var">$res</span>-&gt;<span id="method">start</span>;
						<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$pos_end</span><span id="braces">)</span> = <span id="var">$res</span>-&gt;<span id="method">end</span>;
						<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$pos_strand</span><span id="braces">)</span> = <span id="var">$res</span>-&gt;<span id="method">strand</span>;
						<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$init</span>, <span id="var">$length</span><span id="braces">)</span> = <span id="method">get_block_from_exon</span><span id="braces">(</span><span id="var">$pos_start</span>, <span id="var">$pos_end</span>, <span id="var">$pos_strand</span>, <span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'thick_start'</span><span id="braces">}</span>, <span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'thick_end'</span><span id="braces">}</span><span id="braces">)</span>;
						<span id="perlFunc">push</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'block_starts'</span><span id="braces">}</span><span id="braces">}</span>, <span id="var">$init</span><span id="braces">)</span>;
						<span id="perlFunc">push</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'block_sizes'</span><span id="braces">}</span><span id="braces">}</span>, <span id="var">$length</span><span id="braces">)</span>;
						<span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'blocks'</span><span id="braces">}</span>++;	
					<span id="braces">}</span>
				<span id="braces">}</span>
				$<span id="braces">{</span><span id="var">$ref_output</span><span id="braces">}</span>-&gt;<span id="braces">{</span><span id="sqStr">'body'</span><span id="braces">}</span> .= <span id="method">print_data</span><span id="braces">(</span><span id="var">$data</span><span id="braces">)</span>;
			<span id="braces">}</span>
 		<span id="braces">}</span>
 	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE13" id="CODE13"></a>get_spade_annotations</td><td ><a href="#POD10">description</a></td><td ><a href="#CODE12">prev</a></td><td ><a href="#CODE14">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_spade_annotations</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$transcript_id</span>, <span id="var">$feature</span>, <span id="var">$ref_output</span><span id="braces">)</span> = <span id="var">@_</span>;

	<span id="comment"># Get annotations</span><br /> 	<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$feature</span>-&gt;<span id="method">analysis</span> <span id="braces">)</span> <span id="braces">{</span>
 		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$analysis</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">analysis</span>;
 		<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$analysis</span>-&gt;<span id="method">spade</span> <span id="braces">)</span> <span id="braces">{</span>
	 		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$method</span><span id="braces">)</span> = <span id="var">$analysis</span>-&gt;<span id="method">spade</span>;
	 		<span id="comment"># get residue annotations</span><br />			<span id="perlKey">if</span> <span id="braces">(</span> <span id="perlFunc">defined</span> <span id="var">$method</span>-&gt;<span id="method">regions</span> <span id="braces">)</span> <span id="braces">{</span>
				<span id="comment"># get the residues with 'domain', 'domain_possibly_damaged', 'domain_damaged', and 'domain_wrong' separetly</span><br />				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$res_list</span><span id="braces">)</span> = <span id="var">$method</span>-&gt;<span id="method">regions</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$num_res</span><span id="braces">)</span> = <span id="perlFunc">scalar</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$res_list</span><span id="braces">}</span><span id="braces">)</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$res_domains</span><span id="braces">)</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$res_domain_pos_damaged</span><span id="braces">)</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$res_domain_damaged</span><span id="braces">)</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$res_domain_wrong</span><span id="braces">)</span>;
				<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$res</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$res_list</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
					<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$res</span>-&gt;<span id="method">type_domain</span> <span id="perlKey">eq</span> <span id="sqStr">'domain'</span> <span id="braces">)</span> <span id="braces">{</span>
						<span id="perlFunc">push</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$res_domains</span><span id="braces">}</span>, <span id="var">$res</span><span id="braces">)</span>;
					<span id="braces">}</span>
					<span id="perlKey">elsif</span> <span id="braces">(</span> <span id="var">$res</span>-&gt;<span id="method">type_domain</span> <span id="perlKey">eq</span> <span id="sqStr">'domain_possibly_damaged'</span> <span id="braces">)</span> <span id="braces">{</span>
						<span id="perlFunc">push</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$res_domain_pos_damaged</span><span id="braces">}</span>, <span id="var">$res</span><span id="braces">)</span>;
					<span id="braces">}</span>
					<span id="perlKey">elsif</span> <span id="braces">(</span> <span id="var">$res</span>-&gt;<span id="method">type_domain</span> <span id="perlKey">eq</span> <span id="sqStr">'domain_damaged'</span> <span id="braces">)</span> <span id="braces">{</span>
						<span id="perlFunc">push</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$res_domain_damaged</span><span id="braces">}</span>, <span id="var">$res</span><span id="braces">)</span>;
					<span id="braces">}</span>
					<span id="perlKey">elsif</span> <span id="braces">(</span> <span id="var">$res</span>-&gt;<span id="method">type_domain</span> <span id="perlKey">eq</span> <span id="sqStr">'domain_wrong'</span> <span id="braces">)</span> <span id="braces">{</span>
						<span id="perlFunc">push</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$res_domain_wrong</span><span id="braces">}</span>, <span id="var">$res</span><span id="braces">)</span>;
					<span id="braces">}</span>
				<span id="braces">}</span>
<span id="comment">#open(DATA_7, &quot;&gt;/tmp/data7.log&quot;);</span><br />				
				<span id="method">_aux_get_spade_annotations</span><span id="braces">(</span><span id="sqStr">'domain'</span>,
											<span id="var">$transcript_id</span>,
											<span id="var">$feature</span>,
											<span id="var">$res_domains</span>,
											<span id="var">$ref_output</span><span id="braces">)</span>;
				<span id="method">_aux_get_spade_annotations</span><span id="braces">(</span><span id="sqStr">'domain_possibly_damaged'</span>,
											<span id="var">$transcript_id</span>,
											<span id="var">$feature</span>,
											<span id="var">$res_domain_pos_damaged</span>,
											<span id="var">$ref_output</span><span id="braces">)</span>;
				<span id="method">_aux_get_spade_annotations</span><span id="braces">(</span><span id="sqStr">'domain_damaged'</span>,
											<span id="var">$transcript_id</span>,
											<span id="var">$feature</span>,
											<span id="var">$res_domain_damaged</span>,
											<span id="var">$ref_output</span><span id="braces">)</span>;
				<span id="method">_aux_get_spade_annotations</span><span id="braces">(</span><span id="sqStr">'domain_wrong'</span>,
											<span id="var">$transcript_id</span>,
											<span id="var">$feature</span>,
											<span id="var">$res_domain_wrong</span>,
											<span id="var">$ref_output</span><span id="braces">)</span>;

<span id="comment">#print DATA_7 &quot;\nREPORT:\n&quot;.Dumper($ref_output).&quot;\n&quot;;</span><br /><span id="comment">#close(DATA_7);</span><br />
			<span id="braces">}</span>
 		<span id="braces">}</span>
 	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE14" id="CODE14"></a>get_thump_annotations</td><td ><a href="#POD11">description</a></td><td ><a href="#CODE13">prev</a></td><td ><a href="#CODE15">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_thump_annotations</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$transcript_id</span>, <span id="var">$feature</span>, <span id="var">$ref_output</span><span id="braces">)</span> = <span id="var">@_</span>;

	<span id="comment"># Get annotations</span><br /> 	<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$feature</span>-&gt;<span id="method">analysis</span> <span id="braces">)</span> <span id="braces">{</span>
 		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$analysis</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">analysis</span>;
 		<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$analysis</span>-&gt;<span id="method">thump</span> <span id="braces">)</span> <span id="braces">{</span>
	 		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$method</span><span id="braces">)</span> = <span id="var">$analysis</span>-&gt;<span id="method">thump</span>;
	 		<span id="comment"># get residue annotations</span><br />			<span id="perlKey">if</span> <span id="braces">(</span> <span id="perlFunc">defined</span> <span id="var">$method</span>-&gt;<span id="method">regions</span> <span id="braces">)</span> <span id="braces">{</span>
				<span id="comment"># get the residues with 'transmembrane_helixes', and 'damaged_transmembrane_helixes' separetly</span><br />				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$res_list</span><span id="braces">)</span> = <span id="var">$method</span>-&gt;<span id="method">regions</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$num_res</span><span id="braces">)</span> = <span id="perlFunc">scalar</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$res_list</span><span id="braces">}</span><span id="braces">)</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$res_helix</span><span id="braces">)</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$res_helix_damaged</span><span id="braces">)</span>;
<span id="comment">#print STDERR &quot;\nREGIONS:\n&quot;.Dumper($res_list).&quot;\n&quot;;</span><br />				<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$res</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$res_list</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
					<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$res</span>-&gt;<span id="method">damaged</span> and <span id="braces">(</span><span id="var">$res</span>-&gt;<span id="method">damaged</span> <span id="perlKey">eq</span> <span id="sqStr">'1'</span><span id="braces">)</span> <span id="braces">)</span> <span id="braces">{</span>
						<span id="perlFunc">push</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$res_helix_damaged</span><span id="braces">}</span>, <span id="var">$res</span><span id="braces">)</span>;
					<span id="braces">}</span>
					<span id="perlKey">else</span> <span id="braces">{</span>
						<span id="perlFunc">push</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$res_helix</span><span id="braces">}</span>, <span id="var">$res</span><span id="braces">)</span>;
					<span id="braces">}</span>
				<span id="braces">}</span>
<span id="comment">#open(DATA_7, &quot;&gt;/tmp/data7.log&quot;);</span><br />				
				<span id="method">_aux_get_thump_annotations</span><span id="braces">(</span><span id="sqStr">'transmembrane_helixes'</span>,
											<span id="var">$transcript_id</span>,
											<span id="var">$feature</span>,
											<span id="var">$res_helix</span>,
											<span id="var">$ref_output</span><span id="braces">)</span>;
				<span id="method">_aux_get_thump_annotations</span><span id="braces">(</span><span id="sqStr">'damaged_transmembrane_helixes'</span>,
											<span id="var">$transcript_id</span>,
											<span id="var">$feature</span>,
											<span id="var">$res_helix_damaged</span>,
											<span id="var">$ref_output</span><span id="braces">)</span>;
<span id="comment">#print DATA_7 &quot;\nREPORT:\n&quot;.Dumper($ref_output).&quot;\n&quot;;</span><br /><span id="comment">#close(DATA_7);</span><br />
			<span id="braces">}</span>
 		<span id="braces">}</span>
 	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE15" id="CODE15"></a>get_trans_annotations</td><td ><a href="#POD12">description</a></td><td ><a href="#CODE14">prev</a></td><td ><a href="#CODE16">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_trans_annotations</span>
{<pre>    <span id="perlKey">my</span> <span id="braces">(</span><span id="var">$feature</span>, <span id="var">$position</span>, <span id="var">$source</span><span id="braces">)</span> = <span id="var">@_</span>;

    <span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">ref</span><span id="braces">(</span><span id="var">$feature</span><span id="braces">)</span> and <span id="var">$feature</span>-&gt;<span id="method">isa</span><span id="braces">(</span><span id="dqStr">"APPRIS::Transcript"</span><span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
   	    
		<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$feature</span>-&gt;<span id="method">stable_id</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$feature</span>-&gt;<span id="method">translate</span> and <span id="var">$feature</span>-&gt;<span id="method">translate</span>-&gt;<span id="method">sequence</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$gene_id</span><span id="braces">)</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$transcript_id</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">stable_id</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$external_id</span><span id="braces">)</span> = <span id="var">$feature</span>-&gt;<span id="method">external_name</span>;
				<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$feature</span>-&gt;<span id="method">xref_identify</span><span id="braces">)</span> <span id="braces">{</span>
					<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$xref_identify</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$feature</span>-&gt;<span id="method">xref_identify</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
						<span id="perlKey">if</span> <span id="braces">(</span> <span id="var">$xref_identify</span>-&gt;<span id="method">dbname</span> <span id="perlKey">eq</span> <span id="sqStr">'Ensembl_Gene_Id'</span> <span id="braces">)</span> <span id="braces">{</span>
							<span id="var">$gene_id</span> = <span id="var">$xref_identify</span>-&gt;<span id="method">id</span>;							
						<span id="braces">}</span>
					<span id="braces">}</span>		
				<span id="braces">}</span>
				<span id="perlKey">if</span> <span id="braces">(</span> <span id="braces">(</span><span id="var">$source</span> =~ <span id="regExp">/appris/</span><span id="braces">)</span> or <span id="braces">(</span><span id="var">$source</span> <span id="perlKey">eq</span> <span id="sqStr">'all'</span><span id="braces">)</span> <span id="braces">)</span> <span id="braces">{</span>				
					<span id="method">get_appris_annotations</span><span id="braces">(</span>	<span id="var">$transcript_id</span>,
	           									<span id="var">$feature</span>,\$
	           									BED_TRACKS-&gt;<span id="braces">[</span>0<span id="braces">]</span>
					<span id="braces">)</span>;
				<span id="braces">}</span>
				<span id="perlKey">if</span> <span id="braces">(</span> <span id="braces">(</span><span id="var">$source</span> =~ <span id="regExp">/firestar/</span><span id="braces">)</span> or <span id="braces">(</span><span id="var">$source</span> <span id="perlKey">eq</span> <span id="sqStr">'all'</span><span id="braces">)</span> <span id="braces">)</span> <span id="braces">{</span>				
					<span id="method">get_firestar_annotations</span><span id="braces">(</span>	<span id="var">$transcript_id</span>,
	           									<span id="var">$feature</span>,\$
	           									BED_TRACKS-&gt;<span id="braces">[</span>1<span id="braces">]</span>
					<span id="braces">)</span>;
				<span id="braces">}</span>
				<span id="perlKey">if</span> <span id="braces">(</span> <span id="braces">(</span><span id="var">$source</span> =~ <span id="regExp">/matador3d/</span><span id="braces">)</span> or <span id="braces">(</span><span id="var">$source</span> <span id="perlKey">eq</span> <span id="sqStr">'all'</span><span id="braces">)</span> <span id="braces">)</span> <span id="braces">{</span>				
					<span id="method">get_matador3d_annotations</span><span id="braces">(</span>	<span id="var">$transcript_id</span>,
	           									<span id="var">$feature</span>,\$
	           									BED_TRACKS-&gt;<span id="braces">[</span>2<span id="braces">]</span>
					<span id="braces">)</span>;
				<span id="braces">}</span>
				<span id="perlKey">if</span> <span id="braces">(</span> <span id="braces">(</span><span id="var">$source</span> =~ <span id="regExp">/spade/</span><span id="braces">)</span> or <span id="braces">(</span><span id="var">$source</span> <span id="perlKey">eq</span> <span id="sqStr">'all'</span><span id="braces">)</span> <span id="braces">)</span> <span id="braces">{</span>				
					<span id="method">get_spade_annotations</span><span id="braces">(</span>	<span id="var">$transcript_id</span>,
	           									<span id="var">$feature</span>,\$
	           									BED_TRACKS-&gt;<span id="braces">[</span>3<span id="braces">]</span>
					<span id="braces">)</span>;
				<span id="braces">}</span>
				<span id="perlKey">if</span> <span id="braces">(</span> <span id="braces">(</span><span id="var">$source</span> =~ <span id="regExp">/corsair/</span><span id="braces">)</span> or <span id="braces">(</span><span id="var">$source</span> <span id="perlKey">eq</span> <span id="sqStr">'all'</span><span id="braces">)</span> <span id="braces">)</span> <span id="braces">{</span>				
					<span id="method">get_corsair_annotations</span><span id="braces">(</span>	<span id="var">$transcript_id</span>,
	           									<span id="var">$feature</span>,\$
	           									BED_TRACKS-&gt;<span id="braces">[</span>4<span id="braces">]</span>
					<span id="braces">)</span>;
				<span id="braces">}</span>
				<span id="perlKey">if</span> <span id="braces">(</span> <span id="braces">(</span><span id="var">$source</span> =~ <span id="regExp">/inertia/</span><span id="braces">)</span> or <span id="braces">(</span><span id="var">$source</span> <span id="perlKey">eq</span> <span id="sqStr">'all'</span><span id="braces">)</span> <span id="braces">)</span> <span id="braces">{</span>				
					<span id="method">get_inertia_annotations</span><span id="braces">(</span>	<span id="var">$transcript_id</span>,
	           									<span id="var">$feature</span>,\$
	           									BED_TRACKS-&gt;<span id="braces">[</span>5<span id="braces">]</span>
					<span id="braces">)</span>;
				<span id="braces">}</span>
				<span id="perlKey">if</span> <span id="braces">(</span> <span id="braces">(</span><span id="var">$source</span> =~ <span id="regExp">/crash/</span><span id="braces">)</span> or <span id="braces">(</span><span id="var">$source</span> <span id="perlKey">eq</span> <span id="sqStr">'all'</span><span id="braces">)</span> <span id="braces">)</span> <span id="braces">{</span>				
					<span id="method">get_crash_annotations</span><span id="braces">(</span>	<span id="var">$transcript_id</span>,
	           									<span id="var">$feature</span>,\$
	           									BED_TRACKS-&gt;<span id="braces">[</span>6<span id="braces">]</span>
					<span id="braces">)</span>;
				<span id="braces">}</span>
				<span id="perlKey">if</span> <span id="braces">(</span> <span id="braces">(</span><span id="var">$source</span> =~ <span id="regExp">/thump/</span><span id="braces">)</span> or <span id="braces">(</span><span id="var">$source</span> <span id="perlKey">eq</span> <span id="sqStr">'all'</span><span id="braces">)</span> <span id="braces">)</span> <span id="braces">{</span>				
					<span id="method">get_thump_annotations</span><span id="braces">(</span>	<span id="var">$transcript_id</span>,
	           									<span id="var">$feature</span>,\$
	           									BED_TRACKS-&gt;<span id="braces">[</span>7<span id="braces">]</span>
					<span id="braces">)</span>;
				<span id="braces">}</span>
				<span id="perlKey">if</span> <span id="braces">(</span> <span id="braces">(</span><span id="var">$source</span> =~ <span id="regExp">/cexonic/</span><span id="braces">)</span> or <span id="braces">(</span><span id="var">$source</span> <span id="perlKey">eq</span> <span id="sqStr">'all'</span><span id="braces">)</span> <span id="braces">)</span> <span id="braces">{</span>				
					<span id="method">get_cexonic_annotations</span><span id="braces">(</span>	<span id="var">$transcript_id</span>,
	           									<span id="var">$feature</span>,\$
	           									BED_TRACKS-&gt;<span id="braces">[</span>8<span id="braces">]</span>
					<span id="braces">)</span>;
				<span id="braces">}</span>
			<span id="braces">}</span>
		<span id="braces">}</span>
    <span id="braces">}</span>
    <span id="perlKey">else</span> <span id="braces">{</span>
		<span id="method">throw</span><span id="braces">(</span><span id="sqStr">'Argument must be correct'</span><span id="braces">)</span>;
   	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE16" id="CODE16"></a>print_annotations</td><td ><a href="#POD13">description</a></td><td ><a href="#CODE15">prev</a></td><td ><a href="#CODE17">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">print_annotations</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$report</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$output</span><span id="braces">)</span> = <span id="sqStr">''</span>;
	
	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$method_report</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$report</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">ref</span><span id="braces">(</span><span id="var">$method_report</span><span id="braces">)</span> <span id="perlKey">eq</span> <span id="sqStr">'ARRAY'</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$track_report</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$method_report</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlKey">unless</span><span id="braces">(</span><span id="var">$track_report</span>-&gt;<span id="braces">{</span><span id="sqStr">'body'</span><span id="braces">}</span> <span id="perlKey">eq</span> <span id="sqStr">''</span><span id="braces">)</span> <span id="braces">{</span>
					<span id="var">$output</span>.=<span id="var">$track_report</span>-&gt;<span id="braces">{</span><span id="sqStr">'title'</span><span id="braces">}</span>.<span id="dqStr">"\n"</span>.<span id="var">$track_report</span>-&gt;<span id="braces">{</span><span id="sqStr">'body'</span><span id="braces">}</span>;				
				<span id="braces">}</span>
			<span id="braces">}</span>
		<span id="braces">}</span>
		<span id="perlKey">elsif</span> <span id="braces">(</span><span id="perlFunc">ref</span><span id="braces">(</span><span id="var">$method_report</span><span id="braces">)</span> <span id="perlKey">eq</span> <span id="sqStr">'HASH'</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">unless</span><span id="braces">(</span><span id="var">$method_report</span>-&gt;<span id="braces">{</span><span id="sqStr">'body'</span><span id="braces">}</span> <span id="perlKey">eq</span> <span id="sqStr">''</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="var">$output</span>.=<span id="var">$method_report</span>-&gt;<span id="braces">{</span><span id="sqStr">'title'</span><span id="braces">}</span>.<span id="dqStr">"\n"</span>.<span id="var">$method_report</span>-&gt;<span id="braces">{</span><span id="sqStr">'body'</span><span id="braces">}</span>;			
			<span id="braces">}</span>
		<span id="braces">}</span>
	<span id="braces">}</span>
	<span id="perlKey">return</span> <span id="var">$output</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE17" id="CODE17"></a>print_data</td><td ><a href="#POD14">description</a></td><td ><a href="#CODE16">prev</a></td><td >next</td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">print_data</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$data</span><span id="braces">)</span> = <span id="var">@_</span>;
	
	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$output</span><span id="braces">)</span> = <span id="sqStr">''</span>;

	<span id="var">$output</span> .= <span id="sqStr">'chr'</span>.<span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'chr'</span><span id="braces">}</span>.<span id="dqStr">"\t"</span>.
						<span id="braces">(</span><span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'start'</span><span id="braces">}</span>-1<span id="braces">)</span>.<span id="dqStr">"\t"</span>.
						<span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'end'</span><span id="braces">}</span>.<span id="dqStr">"\t"</span>.
						<span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'name'</span><span id="braces">}</span>.<span id="dqStr">"\t"</span>;

	<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> <span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'score'</span><span id="braces">}</span> and <span id="perlFunc">defined</span> <span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'score'</span><span id="braces">}</span> and
		<span id="perlFunc">exists</span> <span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'strand'</span><span id="braces">}</span> and <span id="perlFunc">defined</span> <span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'strand'</span><span id="braces">}</span>
	<span id="braces">)</span><span id="braces">{</span>
		<span id="var">$output</span>.=<span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'score'</span><span id="braces">}</span>.<span id="dqStr">"\t"</span>.
							<span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'strand'</span><span id="braces">}</span>.<span id="dqStr">"\t"</span>;
	<span id="braces">}</span>

	<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> <span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'thick_start'</span><span id="braces">}</span> and <span id="perlFunc">defined</span> <span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'thick_start'</span><span id="braces">}</span> and
		<span id="perlFunc">exists</span> <span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'thick_end'</span><span id="braces">}</span> and <span id="perlFunc">defined</span> <span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'thick_end'</span><span id="braces">}</span> and
		<span id="perlFunc">exists</span> <span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'color'</span><span id="braces">}</span> and <span id="perlFunc">defined</span> <span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'color'</span><span id="braces">}</span> and
		<span id="perlFunc">exists</span> <span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'blocks'</span><span id="braces">}</span> and <span id="perlFunc">defined</span> <span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'blocks'</span><span id="braces">}</span>
	<span id="braces">)</span><span id="braces">{</span>
		<span id="var">$output</span>.=<span id="braces">(</span><span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'thick_start'</span><span id="braces">}</span>-1<span id="braces">)</span>.<span id="dqStr">"\t"</span>.
							<span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'thick_end'</span><span id="braces">}</span>.<span id="dqStr">"\t"</span>.
							<span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'color'</span><span id="braces">}</span>.<span id="dqStr">"\t"</span>.
							<span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'blocks'</span><span id="braces">}</span>.<span id="dqStr">"\t"</span>;
	<span id="braces">}</span>
	<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> <span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'block_sizes'</span><span id="braces">}</span> and <span id="perlFunc">defined</span> <span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'block_sizes'</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">my</span><span id="braces">(</span><span id="var">@block_sizes</span><span id="braces">)</span>=@<span id="braces">{</span><span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'block_sizes'</span><span id="braces">}</span><span id="braces">}</span>;
		<span id="perlKey">if</span><span id="braces">(</span><span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'strand'</span><span id="braces">}</span> <span id="perlKey">eq</span> <span id="sqStr">'-'</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="var">@block_sizes</span>=<span id="perlFunc">reverse</span> @<span id="braces">{</span><span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'block_sizes'</span><span id="braces">}</span><span id="braces">}</span>;
		<span id="braces">}</span>
		
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$size</span> <span id="braces">(</span><span id="var">@block_sizes</span><span id="braces">)</span>
		<span id="braces">{</span>
			<span id="var">$output</span>.=<span id="var">$size</span>.<span id="sqStr">','</span>;
		<span id="braces">}</span>
		<span id="var">$output</span>=~s<span id="regExp">/,$/</span>\t/;<br />	<span id="braces">}</span>

	<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> <span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'block_starts'</span><span id="braces">}</span> and <span id="perlFunc">defined</span> <span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'block_starts'</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">my</span><span id="braces">(</span><span id="var">@block_starts</span><span id="braces">)</span>=@<span id="braces">{</span><span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'block_starts'</span><span id="braces">}</span><span id="braces">}</span>;
		<span id="perlKey">if</span><span id="braces">(</span><span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'strand'</span><span id="braces">}</span> <span id="perlKey">eq</span> <span id="sqStr">'-'</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="var">@block_starts</span>=<span id="perlFunc">reverse</span> @<span id="braces">{</span><span id="var">$data</span>-&gt;<span id="braces">{</span><span id="sqStr">'block_starts'</span><span id="braces">}</span><span id="braces">}</span>;
		<span id="braces">}</span>
		
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$start</span> <span id="braces">(</span><span id="var">@block_starts</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="var">$output</span>.=<span id="var">$start</span>.<span id="sqStr">','</span>;
		<span id="braces">}</span>
		<span id="var">$output</span>=~s<span id="regExp">/,$/</span>\t/;<br />	<span id="braces">}</span>
	<span id="var">$output</span>=~s<span id="regExp">/\t$/</span>\n/;<br />	
	<span id="perlKey">return</span> <span id="var">$output</span>;</pre>}</td></div>
<div id="sep"></div>
<a name="General" id="General"></a>
<div id="mainTitle">General documentation</div>
<div id="sep"></div>
<table id="genInfoTitle" width="100%"><tr><td><a name="_pod_CONTACT" id="_pod_CONTACT"></a>CONTACT</td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="genInfoArea"><pre id="podParagraph">  Please email comments or questions to the public INB
  developers list at <<a href="mailto:inb-tecnico@lists.cnio.es" id="podEmail">inb-tecnico@lists.cnio.es</a>&gt;.<br />
  Questions may also be sent to the developer, 
  Jose Manuel Rodriguez <<a href="mailto:jmrodriguez@cnio.es" id="podEmail">jmrodriguez@cnio.es</a>&gt;.</pre></div>
<div id="sep"></div>
</body>
</html>
